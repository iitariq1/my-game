<!DOCTYPE html>

<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„Ø¹Ø¨Ø© Ø§Ù„ÙƒÙ†Ø¨Ø© - Ø£Ø³Ø¦Ù„Ø© ÙˆØ£Ø¬ÙˆØ¨Ø©</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

```
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #0f0520 0%, #1a0b2e 25%, #2d1850 50%, #1a0b2e 75%, #0f0520 100%);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
        position: relative;
        overflow-x: hidden;
    }
    
    html {
        background: #0a0315;
    }

    body::before {
        content: 'ğŸŒ™âœ¨ğŸ•Œâœ¨â­âœ¨ğŸŒ™âœ¨ğŸ•Œâœ¨â­';
        position: fixed;
        top: 10px;
        left: 0;
        right: 0;
        text-align: center;
        font-size: 1.5em;
        z-index: 0;
        opacity: 0.6;
        animation: twinkle 3s ease-in-out infinite;
    }

    body::after {
        content: 'â­âœ¨ğŸŒ™âœ¨ğŸ•Œâœ¨â­âœ¨ğŸŒ™âœ¨ğŸ•Œ';
        position: fixed;
        bottom: 10px;
        left: 0;
        right: 0;
        text-align: center;
        font-size: 1.5em;
        z-index: 0;
        opacity: 0.6;
        animation: twinkle 3s ease-in-out infinite 1.5s;
    }

    @keyframes twinkle {
        0%, 100% { opacity: 0.4; }
        50% { opacity: 0.8; }
    }

    .container {
        background: linear-gradient(135deg, #2d1b4e 0%, #4a2c6f 100%);
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0,0,0,0.5), 0 0 30px rgba(212, 175, 55, 0.3);
        max-width: 500px;
        width: 100%;
        padding: 25px;
        position: relative;
        z-index: 1;
        border: 3px solid #d4af37;
    }

    h1 {
        text-align: center;
        background: linear-gradient(135deg, #ffd700 0%, #ffed4e 50%, #ffd700 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 20px;
        font-size: 2em;
        animation: glow 2s ease-in-out infinite;
    }

    @keyframes glow {
        0%, 100% { filter: brightness(1); }
        50% { filter: brightness(1.3); }
    }

    .screen { display: none; }
    .screen.active { display: block; }

    .input-group {
        margin-bottom: 15px;
    }

    .input-group label {
        display: block;
        margin-bottom: 6px;
        font-weight: bold;
        color: #ffd700;
        font-size: 0.95em;
    }

    .input-group input, .input-group select {
        width: 100%;
        padding: 12px;
        border: 2px solid #d4af37;
        border-radius: 10px;
        font-size: 15px;
        background: rgba(45, 27, 78, 0.6);
        color: #ffd700;
        font-weight: bold;
    }
    
    .input-group input::placeholder {
        color: rgba(255, 215, 0, 0.5);
    }
    
    .input-group select {
        color: #ffd700;
    }
    
    .input-group select option {
        background: #2d1b4e;
        color: #ffd700;
    }

    .btn {
        width: 100%;
        padding: 12px;
        background: linear-gradient(135deg, #d4af37 0%, #aa8929 100%);
        color: #1a0b2e;
        border: none;
        border-radius: 10px;
        font-size: 1.1em;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s;
        margin-top: 8px;
        box-shadow: 0 4px 12px rgba(212, 175, 55, 0.4);
    }

    .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 16px rgba(212, 175, 55, 0.6);
    }

    .btn.secondary {
        background: linear-gradient(135deg, #6a4c93 0%, #533a71 100%);
        color: #ffd700;
    }

    .btn.success {
        background: linear-gradient(135deg, #00a86b 0%, #008c59 100%);
        color: white;
    }

    .btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }

    .room-code {
        text-align: center;
        padding: 20px;
        background: linear-gradient(135deg, rgba(212, 175, 55, 0.2) 0%, rgba(170, 137, 41, 0.2) 100%);
        border-radius: 15px;
        margin: 15px 0;
        border: 2px solid #d4af37;
    }

    .room-code h2 {
        color: #ffd700;
        font-size: 1.2em;
        margin-bottom: 8px;
    }

    .code {
        font-size: 2.5em;
        font-weight: bold;
        color: #ffd700;
        letter-spacing: 8px;
        font-family: monospace;
        text-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
    }

    .players-list {
        background: linear-gradient(135deg, rgba(212, 175, 55, 0.15) 0%, rgba(170, 137, 41, 0.15) 100%);
        border-radius: 15px;
        padding: 15px;
        margin: 15px 0;
        border: 2px solid rgba(212, 175, 55, 0.5);
    }

    .players-list h3 {
        color: #ffd700;
        margin-bottom: 12px;
        font-size: 1.1em;
    }

    .player-item {
        background: linear-gradient(135deg, rgba(74, 44, 111, 0.7) 0%, rgba(45, 27, 78, 0.7) 100%);
        padding: 10px 12px;
        margin-bottom: 8px;
        border-radius: 8px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        border: 1px solid #d4af37;
    }

    .player-name {
        font-weight: bold;
        color: #ffd700;
        font-size: 0.95em;
    }

    .team-badge {
        padding: 4px 12px;
        border-radius: 15px;
        font-size: 0.85em;
        font-weight: bold;
        color: white;
    }

    .team-badge.team1 {
        background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
    }

    .team-badge.team2 {
        background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
    }

    .host-badge {
        background: linear-gradient(135deg, #ffd700 0%, #aa8929 100%);
        padding: 4px 12px;
        border-radius: 15px;
        font-size: 0.8em;
        color: #1a0b2e;
        font-weight: bold;
    }

    .teams-players-display {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 8px;
        margin-bottom: 8px;
    }

    .team-players-section {
        background: linear-gradient(135deg, rgba(212, 175, 55, 0.15) 0%, rgba(170, 137, 41, 0.15) 100%);
        padding: 8px;
        border-radius: 10px;
        border: 2px solid rgba(212, 175, 55, 0.5);
    }

    .team-header {
        color: #ffd700;
        font-size: 0.95em;
        margin-bottom: 5px;
        text-align: center;
    }

    .players-list-game {
        display: flex;
        flex-direction: column;
        gap: 4px;
    }

    .player-name-tag {
        background: linear-gradient(135deg, rgba(74, 44, 111, 0.8) 0%, rgba(45, 27, 78, 0.8) 100%);
        padding: 4px 6px;
        border-radius: 5px;
        text-align: center;
        font-weight: bold;
        color: #ffd700;
        border: 2px solid #d4af37;
        font-size: 0.8em;
    }

    .player-name-tag.on-couch {
        opacity: 0.5;
        text-decoration: line-through;
    }

    .couch-display-player {
        background: linear-gradient(135deg, rgba(212, 175, 55, 0.3) 0%, rgba(170, 137, 41, 0.3) 100%);
        padding: 8px;
        border-radius: 10px;
        border: 3px solid #ffd700;
        margin-bottom: 8px;
        box-shadow: 0 0 15px rgba(255, 215, 0, 0.3);
    }

    .couch-display-player h3 {
        text-align: center;
        color: #ffd700;
        font-size: 1em;
        margin-bottom: 6px;
    }

    .couch-seats-player {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 6px;
    }

    .couch-team-player {
        background: rgba(255, 255, 255, 0.1);
        padding: 5px;
        border-radius: 6px;
        border: 2px solid rgba(212, 175, 55, 0.5);
    }

    .couch-team-player h4 {
        color: #ffd700;
        font-size: 0.8em;
        margin-bottom: 4px;
        text-align: center;
    }

    .couch-player {
        background: linear-gradient(135deg, #ffd700 0%, #d4af37 100%);
        padding: 5px 8px;
        margin-bottom: 4px;
        border-radius: 6px;
        text-align: center;
        font-weight: bold;
        color: #1a0b2e;
        box-shadow: 0 2px 6px rgba(212, 175, 55, 0.4);
        animation: slideIn 0.5s ease-out;
        font-size: 0.8em;
    }

    @keyframes slideIn {
        from { opacity: 0; transform: translateX(-20px); }
        to { opacity: 1; transform: translateX(0); }
    }

    .couch-empty {
        text-align: center;
        color: rgba(255, 215, 0, 0.5);
        font-style: italic;
        padding: 6px;
        font-size: 0.85em;
    }

    .on-couch-message {
        background: linear-gradient(135deg, rgba(0, 168, 107, 0.3) 0%, rgba(0, 140, 89, 0.3) 100%);
        border: 3px solid #00a86b;
        border-radius: 12px;
        padding: 25px 12px;
        margin: 12px 0;
        text-align: center;
    }

    .on-couch-message .trophy-icon {
        font-size: 3.5em;
        margin-bottom: 8px;
        animation: bounce 2s ease-in-out infinite;
    }

    @keyframes bounce {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-15px); }
    }

    .on-couch-message h2 {
        color: #00a86b;
        font-size: 1.6em;
        margin-bottom: 8px;
    }

    .on-couch-message p {
        color: #52c997;
        font-size: 1em;
        font-weight: bold;
    }

    .question-display {
        background: linear-gradient(135deg, rgba(212, 175, 55, 0.2) 0%, rgba(170, 137, 41, 0.2) 100%);
        padding: 12px;
        border-radius: 10px;
        margin-bottom: 10px;
        min-height: 50px;
        border: 2px solid #d4af37;
    }

    .question-text {
        font-size: 1em;
        color: #ffd700;
        text-align: center;
        margin-bottom: 6px;
    }

    .timer-display {
        text-align: center;
        font-size: 1.8em;
        font-weight: bold;
        background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin: 8px 0;
    }

    .timer-display.warning {
        background: linear-gradient(135deg, #ff4444 0%, #cc0000 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        animation: pulse 0.5s infinite;
    }

    @keyframes pulse {
        0%, 100% { opacity: 1; transform: scale(1); }
        50% { opacity: 0.7; transform: scale(1.1); }
    }

    .buzzer-indicator {
        text-align: center;
        padding: 6px;
        margin: 6px 0;
        background: linear-gradient(135deg, rgba(255, 107, 53, 0.3) 0%, rgba(247, 147, 30, 0.3) 100%);
        border-radius: 8px;
        border: 2px solid #ff6b35;
        color: #ffd700;
        font-weight: bold;
        font-size: 0.85em;
    }

    .status-message {
        text-align: center;
        padding: 8px;
        margin: 8px 0;
        border-radius: 8px;
        font-size: 0.9em;
        font-weight: bold;
        border: 2px solid;
    }

    .status-message.info {
        background: linear-gradient(135deg, rgba(52, 152, 219, 0.2) 0%, rgba(41, 128, 185, 0.2) 100%);
        color: #5dade2;
        border-color: #3498db;
    }

    .status-message.success {
        background: linear-gradient(135deg, rgba(0, 168, 107, 0.2) 0%, rgba(0, 140, 89, 0.2) 100%);
        color: #52c997;
        border-color: #00a86b;
    }

    .status-message.error {
        background: linear-gradient(135deg, rgba(231, 76, 60, 0.2) 0%, rgba(192, 57, 43, 0.2) 100%);
        color: #ec7063;
        border-color: #e74c3c;
    }

    .status-message.warning {
        background: linear-gradient(135deg, rgba(243, 156, 18, 0.2) 0%, rgba(230, 126, 34, 0.2) 100%);
        color: #f5b041;
        border-color: #f39c12;
    }

    .buzz-button {
        width: 100%;
        height: 90px;
        font-size: 1.5em;
        background: linear-gradient(135deg, #ff6b35 0%, #f7931e 50%, #ff6b35 100%);
        color: white;
        border: none;
        border-radius: 12px;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s;
        box-shadow: 0 6px 20px rgba(255, 107, 53, 0.5);
        border: 3px solid #ffd700;
        position: relative;
        overflow: hidden;
        margin: 10px 0;
    }

    .buzz-button::before {
        content: 'ğŸ””';
        position: absolute;
        font-size: 1.6em;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        opacity: 0.3;
    }

    .buzz-button:active:not(:disabled) {
        transform: scale(0.95);
    }

    .buzz-button:disabled {
        background: linear-gradient(135deg, #555 0%, #333 100%);
        cursor: not-allowed;
        box-shadow: none;
        border-color: #555;
    }

    .answer-input-container {
        margin: 12px 0;
    }

    .answer-timer {
        text-align: center;
        font-size: 2em;
        font-weight: bold;
        color: #ffd700;
        margin: 8px 0;
        background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    .answer-timer.warning {
        background: linear-gradient(135deg, #ff4444 0%, #cc0000 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        animation: pulse 0.5s infinite;
    }

    .answer-input {
        width: 100%;
        padding: 12px;
        border: 3px solid #ffd700;
        border-radius: 10px;
        font-size: 1em;
        font-weight: bold;
        text-align: center;
        background: rgba(45, 27, 78, 0.6);
        color: #ffd700;
    }
    
    .answer-input::placeholder {
        color: rgba(255, 215, 0, 0.5);
    }

    .answer-input:focus {
        outline: none;
        box-shadow: 0 0 15px rgba(255, 215, 0, 0.6);
    }

    .submit-answer-btn {
        width: 100%;
        padding: 12px;
        background: linear-gradient(135deg, #00a86b 0%, #008c59 100%);
        color: white;
        border: none;
        border-radius: 10px;
        font-size: 1.1em;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s;
        margin-top: 8px;
        box-shadow: 0 4px 12px rgba(0, 168, 107, 0.4);
    }

    .submit-answer-btn:hover:not(:disabled) {
        transform: translateY(-2px);
    }

    .answer-options {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 8px;
        margin-top: 10px;
    }

    .answer-btn {
        padding: 12px 8px;
        background: linear-gradient(135deg, rgba(74, 44, 111, 0.7) 0%, rgba(45, 27, 78, 0.7) 100%);
        border: 3px solid #d4af37;
        border-radius: 10px;
        font-size: 0.9em;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s;
        color: #ffd700;
        min-height: 60px;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
    }

    .answer-btn:hover:not(:disabled) {
        background: linear-gradient(135deg, #ffd700 0%, #d4af37 100%);
        color: #1a0b2e;
        transform: translateY(-2px);
    }

    .player-choice-buttons {
        display: grid;
        grid-template-columns: 1fr;
        gap: 10px;
        margin-top: 12px;
    }

    .choice-btn {
        padding: 15px;
        border: none;
        border-radius: 12px;
        font-size: 1em;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s;
        border: 3px solid;
    }

    .choice-btn.sit {
        background: linear-gradient(135deg, #00a86b 0%, #008c59 100%);
        color: white;
        border-color: #00a86b;
    }

    .choice-btn.steal {
        background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        color: white;
        border-color: #c0392b;
    }

    .choice-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.3);
    }

    .victory-screen {
        text-align: center;
        padding: 40px;
    }

    .victory-screen h2 {
        font-size: 2.5em;
        background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        margin-bottom: 25px;
        animation: glow 1s ease-in-out infinite;
    }

    .confetti {
        font-size: 4em;
        margin-bottom: 15px;
        animation: bounce 1s ease-in-out infinite;
    }

    @media (max-width: 768px) {
        .container { padding: 18px; }
        h1 { font-size: 1.7em; }
        .code { font-size: 2em; letter-spacing: 5px; }
        .question-text { font-size: 0.95em; }
        .timer-display { font-size: 1.6em; }
        .buzz-button { height: 80px; font-size: 1.3em; }
        .answer-btn { font-size: 0.8em; min-height: 50px; }
    }
</style>
```

</head>
<body>
    <div class="container" id="mainContainer">
        <!-- Welcome Screen -->
        <div class="screen active" id="welcomeScreen">
            <h1>ğŸ›‹ï¸ Ù„Ø¹Ø¨Ø© Ø§Ù„ÙƒÙ†Ø¨Ø© ğŸŒ™</h1>
            <div style="text-align: center; color: #ffd700; margin-bottom: 25px; font-size: 1em;">
                âœ¨ Ø±Ù…Ø¶Ø§Ù† ÙƒØ±ÙŠÙ… âœ¨
            </div>
            <div class="input-group">
                <button class="btn" onclick="showCreateRoom()">ğŸ® Ø¥Ù†Ø´Ø§Ø¡ ØºØ±ÙØ© Ø¬Ø¯ÙŠØ¯Ø©</button>
            </div>
            <div class="input-group">
                <button class="btn secondary" onclick="showJoinRoom()">ğŸšª Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ù„ØºØ±ÙØ©</button>
            </div>
            <div class="input-group">
                <button class="btn" style="background: linear-gradient(135deg, #6a4c93 0%, #533a71 100%); color: #ffd700;" onclick="window.location.href='../index.html">ğŸ  Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
            </div>
        </div>

```
    <!-- Create Room Screen -->
    <div class="screen" id="createRoomScreen">
        <h1>Ø¥Ù†Ø´Ø§Ø¡ ØºØ±ÙØ© Ø¬Ø¯ÙŠØ¯Ø© ğŸŒ™</h1>
        <div class="input-group">
            <label>Ø§Ø³Ù…Ùƒ:</label>
            <input type="text" id="hostName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ">
        </div>
        <div class="input-group">
            <label>Ø§Ø³Ù… Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£ÙˆÙ„:</label>
            <input type="text" id="team1NameInput" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ø£Ø¨Ø·Ø§Ù„" value="Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø­Ù…Ø±">
        </div>
        <div class="input-group">
            <label>Ø§Ø³Ù… Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø«Ø§Ù†ÙŠ:</label>
            <input type="text" id="team2NameInput" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ù†Ø¬ÙˆÙ…" value="Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø²Ø±Ù‚">
        </div>
        <div class="input-group">
            <label>Ø¹Ø¯Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† ÙÙŠ ÙƒÙ„ ÙØ±ÙŠÙ‚:</label>
            <select id="teamSizeInput">
                <option value="2">2 Ù„Ø§Ø¹Ø¨ÙŠÙ†</option>
                <option value="3">3 Ù„Ø§Ø¹Ø¨ÙŠÙ†</option>
                <option value="4">4 Ù„Ø§Ø¹Ø¨ÙŠÙ†</option>
                <option value="5">5 Ù„Ø§Ø¹Ø¨ÙŠÙ†</option>
            </select>
        </div>
        <button class="btn" onclick="createRoom()">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØºØ±ÙØ©</button>
        <button class="btn secondary" onclick="showWelcome()">Ø±Ø¬ÙˆØ¹</button>
    </div>

    <!-- Join Room Screen -->
    <div class="screen" id="joinRoomScreen">
        <h1>Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ù„ØºØ±ÙØ© ğŸŒ™</h1>
        <div class="input-group">
            <label>Ø§Ø³Ù…Ùƒ:</label>
            <input type="text" id="playerName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ">
        </div>
        <div class="input-group">
            <label>ÙƒÙˆØ¯ Ø§Ù„ØºØ±ÙØ©:</label>
            <input type="text" id="roomCode" placeholder="0000" maxlength="4" pattern="[0-9]*">
        </div>
        <button class="btn" onclick="joinRoom()">Ø§Ù†Ø¶Ù…</button>
        <button class="btn secondary" onclick="showWelcome()">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
    </div>

    <!-- Lobby Screen -->
    <div class="screen" id="lobbyScreen">
        <h1>ØºØ±ÙØ© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± ğŸŒ™</h1>
        <div class="room-code">
            <h2>ÙƒÙˆØ¯ Ø§Ù„ØºØ±ÙØ©:</h2>
            <div class="code" id="displayRoomCode">0000</div>
            <p style="margin-top: 8px; color: #ffd700; font-size: 0.9em;">Ø´Ø§Ø±Ùƒ Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ù…Ø¹ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†</p>
        </div>
        <div class="status-message info" style="margin-bottom: 15px;">
            <p><strong>Ø§Ø®ØªØ± ÙØ±ÙŠÙ‚Ùƒ Ù„Ù„Ø¹Ø¨:</strong></p>
        </div>
        <div id="hostTeamButtons" style="margin-bottom: 15px;"></div>
        <div class="players-list">
            <h3>Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† (<span id="playerCount">0</span>)</h3>
            <div id="playersListContainer"></div>
        </div>
        <button class="btn success" onclick="startGame()" id="startGameBtn" disabled>Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø© â–¶ï¸</button>
    </div>

    <!-- Team Selection Screen -->
    <div class="screen" id="teamSelectionScreen">
        <h1>Ø§Ø®ØªØ± ÙØ±ÙŠÙ‚Ùƒ ğŸŒ™</h1>
        <div class="status-message info">
            <p>Ù…Ø±Ø­Ø¨Ø§Ù‹ <strong><span id="welcomePlayerName"></span></strong></p>
            <p>Ø§Ø®ØªØ± Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ø¥Ù„ÙŠÙ‡</p>
        </div>
        <div id="teamButtons"></div>
    </div>

    <!-- Waiting Screen -->
    <div class="screen" id="waitingScreen">
        <h1>ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø¨Ø¯Ø¡... ğŸŒ™</h1>
        <div class="status-message info">
            <p>Ø£Ù†Øª ÙÙŠ <strong><span id="playerTeamName"></span></strong></p>
            <p>Ø§Ù†ØªØ¸Ø± Ø­ØªÙ‰ ÙŠØ¨Ø¯Ø£ Ø§Ù„Ù…Ø¶ÙŠÙ Ø§Ù„Ù„Ø¹Ø¨Ø©</p>
        </div>
        <div class="players-list">
            <h3>Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† ÙÙŠ Ø§Ù„ØºØ±ÙØ©:</h3>
            <div id="waitingPlayersListContainer"></div>
        </div>
    </div>

    <!-- Player Game Screen -->
    <div class="screen" id="playerGameScreen">
        <h1>ğŸ›‹ï¸ Ù„Ø¹Ø¨Ø© Ø§Ù„ÙƒÙ†Ø¨Ø© ğŸŒ™</h1>
        
        <div class="teams-players-display" id="teamsPlayersDisplay">
            <div class="team-players-section">
                <h3 id="playerTeam1Name" class="team-header">Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£ÙˆÙ„</h3>
                <div id="team1PlayersList" class="players-list-game"></div>
            </div>
            <div class="team-players-section">
                <h3 id="playerTeam2Name" class="team-header">Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø«Ø§Ù†ÙŠ</h3>
                <div id="team2PlayersList" class="players-list-game"></div>
            </div>
        </div>

        <div class="couch-display-player">
            <h3>ğŸ›‹ï¸ ÙƒÙ†Ø¨Ø© Ø§Ù„ÙÙˆØ² ğŸ›‹ï¸</h3>
            <div class="couch-seats-player">
                <div class="couch-team-player">
                    <h4 id="playerCouchTeam1">Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£ÙˆÙ„</h4>
                    <div id="playerTeam1Couch"></div>
                </div>
                <div class="couch-team-player">
                    <h4 id="playerCouchTeam2">Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø«Ø§Ù†ÙŠ</h4>
                    <div id="playerTeam2Couch"></div>
                </div>
            </div>
        </div>

        <div class="on-couch-message" id="onCouchMessage" style="display: none;">
            <div class="trophy-icon">ğŸ†</div>
            <h2>Ø£Ù†Øª Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ†Ø¨Ø©!</h2>
            <p>Ø§Ø³ØªØ±Ø®Ù ÙˆØ§Ù†ØªØ¸Ø± Ø§Ù„ÙÙˆØ² ğŸŒŸ</p>
        </div>

        <div id="gameElements">
            <div class="question-display" id="playerQuestionDisplay" style="display: none;">
                <div class="question-text" id="playerQuestionText"></div>
            </div>

            <div class="timer-display" id="playerTimer" style="display: none;">--</div>

            <div id="buzzerIndicator"></div>

            <div class="status-message info" id="playerStatus">Ø§Ù†ØªØ¸Ø± Ø§Ù„Ø³Ø¤Ø§Ù„...</div>

            <div class="player-controls">
                <button class="buzz-button" id="buzzButton" onclick="buzzIn()" disabled>
                    Ø§Ø¶ØºØ· Ø§Ù„Ø¬Ø±Ø³! ğŸ””
                </button>
            </div>

            <div class="answer-input-container" id="answerInputContainer" style="display: none;">
                <div class="answer-timer" id="answerTimer" style="display: none;">5</div>
                <input type="text" class="answer-input" id="textAnswerInput" placeholder="Ø§ÙƒØªØ¨ Ø¥Ø¬Ø§Ø¨ØªÙƒ Ù‡Ù†Ø§..." autocomplete="off">
                <button class="submit-answer-btn" id="submitAnswerBtn" onclick="submitTextAnswer()">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© âœ“</button>
            </div>

            <div class="answer-options" id="playerAnswerOptions"></div>

            <div class="player-choice-buttons" id="playerChoiceButtons"></div>
        </div>

        <div id="hostControlsPlayer" style="display: none; margin-top: 10px;">
            <button class="btn" onclick="nextQuestion()" id="nextQuestionBtnPlayer">Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ â–¶ï¸</button>
        </div>

        <div class="victory-screen" id="victoryScreenPlayer" style="display: none;">
            <div class="confetti">ğŸ‰ğŸŒ™ğŸŠâœ¨ğŸ†</div>
            <h2 id="victoryMessagePlayer">ÙØ§Ø² Ø§Ù„ÙØ±ÙŠÙ‚!</h2>
            <div class="confetti">ğŸ†âœ¨ğŸŠğŸŒ™ğŸ‰</div>
            <button class="btn" onclick="location.reload()">Ù„Ø¹Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</button>
        </div>
    </div>
</div>

<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
<script>
    const firebaseConfig = {
        apiKey: "AIzaSyBUXlgxP463b18dg9_Og_8EcMDLfLIr76o",
        authDomain: "team-cc63c.firebaseapp.com",
        databaseURL: "https://team-cc63c-default-rtdb.europe-west1.firebasedatabase.app/",
        projectId: "team-cc63c",
        storageBucket: "team-cc63c.firebasestorage.app",
        messagingSenderId: "511582595742",
        appId: "1:511582595742:web:3e21273dcf49bf26d7298f",
        measurementId: "G-PSDJ9N34PH"
    };

    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    const questions = [
        {category: "Ø¯ÙŠÙ†ÙŠØ©", question: "ÙƒÙ… Ø¹Ø¯Ø¯ Ø³ÙˆØ± Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…ØŸ", options: ["114 Ø³ÙˆØ±Ø©", "110 Ø³ÙˆØ±Ø©", "120 Ø³ÙˆØ±Ø©", "100 Ø³ÙˆØ±Ø©"], correct: 0},
        {category: "Ø¯ÙŠÙ†ÙŠØ©", question: "Ù…Ø§ Ù‡ÙŠ Ø£Ø·ÙˆÙ„ Ø³ÙˆØ±Ø© ÙÙŠ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…ØŸ", options: ["Ø³ÙˆØ±Ø© Ø§Ù„Ø¨Ù‚Ø±Ø©", "Ø³ÙˆØ±Ø© Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†", "Ø³ÙˆØ±Ø© Ø§Ù„Ù†Ø³Ø§Ø¡", "Ø³ÙˆØ±Ø© Ø§Ù„Ø£Ø¹Ø±Ø§Ù"], correct: 0},
        {category: "Ø¯ÙŠÙ†ÙŠØ©", question: "ÙƒÙ… Ø¹Ø¯Ø¯ Ø£Ø±ÙƒØ§Ù† Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ØŸ", options: ["5 Ø£Ø±ÙƒØ§Ù†", "4 Ø£Ø±ÙƒØ§Ù†", "6 Ø£Ø±ÙƒØ§Ù†", "7 Ø£Ø±ÙƒØ§Ù†"], correct: 0},
        {category: "Ø¯ÙŠÙ†ÙŠØ©", question: "Ù…Ù† Ù‡Ùˆ Ø®Ø§ØªÙ… Ø§Ù„Ø£Ù†Ø¨ÙŠØ§Ø¡ØŸ", options: ["Ù…Ø­Ù…Ø¯ ï·º", "Ø¹ÙŠØ³Ù‰ Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø³Ù„Ø§Ù…", "Ù…ÙˆØ³Ù‰ Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø³Ù„Ø§Ù…", "Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø³Ù„Ø§Ù…"], correct: 0},
        {category: "Ø¯ÙŠÙ†ÙŠØ©", question: "ÙÙŠ Ø£ÙŠ Ø´Ù‡Ø± ÙØ±Ø¶ Ø§Ù„ØµÙŠØ§Ù…ØŸ", options: ["Ø±Ù…Ø¶Ø§Ù†", "Ø´Ø¹Ø¨Ø§Ù†", "Ø±Ø¬Ø¨", "Ø°Ùˆ Ø§Ù„Ù‚Ø¹Ø¯Ø©"], correct: 0},
        {category: "Ø«Ù‚Ø§ÙÙŠØ©", question: "Ù…Ù† Ù‡Ùˆ Ù…Ø¤Ù„Ù Ø±ÙˆØ§ÙŠØ© 'Ù…Ø¦Ø© Ø¹Ø§Ù… Ù…Ù† Ø§Ù„Ø¹Ø²Ù„Ø©'ØŸ", options: ["ØºØ§Ø¨Ø±ÙŠÙŠÙ„ ØºØ§Ø±Ø³ÙŠØ§ Ù…Ø§Ø±ÙƒÙŠØ²", "Ø¨Ø§Ø¨Ù„Ùˆ Ù†ÙŠØ±ÙˆØ¯Ø§", "Ø®ÙˆØ±Ø®ÙŠ Ù„ÙˆÙŠØ³ Ø¨ÙˆØ±Ø®ÙŠØ³", "Ø¥ÙŠØ²Ø§Ø¨ÙŠÙ„ Ø§Ù„Ù„ÙŠÙ†Ø¯ÙŠ"], correct: 0},
        {category: "Ø¬ØºØ±Ø§ÙÙŠØ©", question: "Ù…Ø§ Ù‡ÙŠ Ø¹Ø§ØµÙ…Ø© Ø§Ù„ÙŠØ§Ø¨Ø§Ù†ØŸ", options: ["Ø·ÙˆÙƒÙŠÙˆ", "ÙƒÙŠÙˆØªÙˆ", "Ø£ÙˆØ³Ø§ÙƒØ§", "ÙŠÙˆÙƒÙˆÙ‡Ø§Ù…Ø§"], correct: 0},
        {category: "Ø±ÙŠØ§Ø¶ÙŠØ©", question: "ÙƒÙ… Ø¹Ø¯Ø¯ Ù„Ø§Ø¹Ø¨ÙŠ ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù… ÙÙŠ Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„ÙˆØ§Ø­Ø¯ØŸ", options: ["11 Ù„Ø§Ø¹Ø¨Ø§Ù‹", "10 Ù„Ø§Ø¹Ø¨ÙŠÙ†", "12 Ù„Ø§Ø¹Ø¨Ø§Ù‹", "9 Ù„Ø§Ø¹Ø¨ÙŠÙ†"], correct: 0},
        {category: "Ø¹Ù„Ù…ÙŠØ©", question: "ÙƒÙ… Ø¹Ø¯Ø¯ ÙƒÙˆØ§ÙƒØ¨ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø´Ù…Ø³ÙŠØ©ØŸ", options: ["8 ÙƒÙˆØ§ÙƒØ¨", "9 ÙƒÙˆØ§ÙƒØ¨", "7 ÙƒÙˆØ§ÙƒØ¨", "10 ÙƒÙˆØ§ÙƒØ¨"], correct: 0},
        {category: "Ø¹Ø§Ù…Ø©", question: "ÙƒÙ… Ø¹Ø¯Ø¯ Ø£Ù„ÙˆØ§Ù† Ù‚ÙˆØ³ Ù‚Ø²Ø­ØŸ", options: ["7 Ø£Ù„ÙˆØ§Ù†", "6 Ø£Ù„ÙˆØ§Ù†", "8 Ø£Ù„ÙˆØ§Ù†", "5 Ø£Ù„ÙˆØ§Ù†"], correct: 0}
    ];

    let currentRoomCode = null;
    let currentPlayerId = null;
    let currentPlayerName = null;
    let isHost = false;
    let currentTeam = null;
    let timerInterval = null;
    let roomData = null;
    let answerTimerInterval = null;

    function showWelcome() {
        if (currentRoomCode && currentPlayerId) {
            database.ref('rooms/' + currentRoomCode + '/players/' + currentPlayerId).remove();
        }
        currentRoomCode = null;
        currentPlayerId = null;
        currentPlayerName = null;
        isHost = false;
        currentTeam = null;
        roomData = null;
        hideAllScreens();
        document.getElementById('welcomeScreen').classList.add('active');
    }

    function goToMainPage() {
        if (currentRoomCode && currentPlayerId) {
            database.ref('rooms/' + currentRoomCode + '/players/' + currentPlayerId).remove();
        }
        window.location.href = 'index.html';
    }

    function showCreateRoom() {
        hideAllScreens();
        document.getElementById('createRoomScreen').classList.add('active');
    }

    function showJoinRoom() {
        hideAllScreens();
        document.getElementById('joinRoomScreen').classList.add('active');
    }

    function hideAllScreens() {
        document.querySelectorAll('.screen').forEach(screen => screen.classList.remove('active'));
    }

    function generateRoomCode() {
        return Math.floor(1000 + Math.random() * 9000).toString();
    }

    function createRoom() {
        const hostName = document.getElementById('hostName').value.trim();
        const team1Name = document.getElementById('team1NameInput').value.trim() || 'Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø­Ù…Ø±';
        const team2Name = document.getElementById('team2NameInput').value.trim() || 'Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø²Ø±Ù‚';
        const teamSize = parseInt(document.getElementById('teamSizeInput').value);

        if (!hostName) {
            alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù…Ùƒ');
            return;
        }

        currentRoomCode = generateRoomCode();
        currentPlayerId = 'host-' + Date.now();
        currentPlayerName = hostName;
        isHost = true;

        database.ref('rooms/' + currentRoomCode).set({
            code: currentRoomCode,
            host: currentPlayerId,
            team1Name: team1Name,
            team2Name: team2Name,
            teamSize: teamSize,
            players: {
                [currentPlayerId]: { name: hostName, isHost: true, team: null }
            },
            gameState: 'lobby',
            currentQuestion: null,
            usedQuestions: [],
            team1Couch: [],
            team2Couch: [],
            team1Score: 0,
            team2Score: 0,
            buzzedPlayer: null,
            showOptions: false,
            bannedTeam: null,
            correctAnswer: null,
            waitingForChoice: false,
            choicePlayer: null,
            waitingForTextAnswer: false
        });

        listenToRoom();
        showLobby();
    }

    function joinRoom() {
        const playerName = document.getElementById('playerName').value.trim();
        const roomCode = document.getElementById('roomCode').value.trim();

        if (!playerName) {
            alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù…Ùƒ');
            return;
        }

        if (!roomCode || roomCode.length !== 4) {
            alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„ØºØ±ÙØ© (4 Ø£Ø±Ù‚Ø§Ù…)');
            return;
        }

        database.ref('rooms/' + roomCode).once('value', (snapshot) => {
            if (!snapshot.exists()) {
                alert('Ø§Ù„ØºØ±ÙØ© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©');
                return;
            }

            currentRoomCode = roomCode;
            currentPlayerId = 'player-' + Date.now();
            currentPlayerName = playerName;
            isHost = false;

            database.ref('rooms/' + currentRoomCode + '/players/' + currentPlayerId).set({
                name: playerName,
                isHost: false,
                team: null
            });

            listenToRoom();
            showTeamSelection();
        });
    }

    function listenToRoom() {
        database.ref('rooms/' + currentRoomCode).on('value', (snapshot) => {
            if (snapshot.exists()) {
                roomData = snapshot.val();
                updateUI();
            }
        });
    }

    function updateUI() {
        if (!roomData) return;

        if (isHost) {
            if (roomData.gameState === 'lobby') {
                updateLobby();
            } else if (roomData.gameState === 'playing') {
                updatePlayerGameScreen();
            }
        } else {
            if (roomData.gameState === 'lobby' && !currentTeam) {
                updateTeamSelection();
                showTeamSelection();
            } else if (roomData.gameState === 'lobby' && currentTeam) {
                updateWaitingScreen();
            } else if (roomData.gameState === 'playing') {
                updatePlayerGameScreen();
            }
        }
    }

    function showLobby() {
        hideAllScreens();
        document.getElementById('lobbyScreen').classList.add('active');
        document.getElementById('displayRoomCode').textContent = currentRoomCode;
        
        const hostTeamButtons = document.getElementById('hostTeamButtons');
        hostTeamButtons.innerHTML = '';

        const team1Btn = document.createElement('button');
        team1Btn.className = 'btn';
        team1Btn.textContent = 'ğŸ”´ ' + roomData.team1Name;
        team1Btn.id = 'hostTeam1Btn';
        team1Btn.onclick = () => selectHostTeam('team1');
        hostTeamButtons.appendChild(team1Btn);

        const team2Btn = document.createElement('button');
        team2Btn.className = 'btn secondary';
        team2Btn.textContent = 'ğŸ”µ ' + roomData.team2Name;
        team2Btn.id = 'hostTeam2Btn';
        team2Btn.onclick = () => selectHostTeam('team2');
        hostTeamButtons.appendChild(team2Btn);
    }

    function updateLobby() {
        const players = roomData.players || {};
        const playerCount = Object.keys(players).length;
        const teamSize = roomData.teamSize || 2;
        const requiredPlayers = teamSize * 2;

        document.getElementById('playerCount').textContent = playerCount;

        const playersListContainer = document.getElementById('playersListContainer');
        playersListContainer.innerHTML = '';

        Object.entries(players).forEach(([id, player]) => {
            const div = document.createElement('div');
            div.className = 'player-item';
            
            const nameSpan = document.createElement('span');
            nameSpan.className = 'player-name';
            nameSpan.textContent = player.name;
            
            const badgeContainer = document.createElement('div');
            
            if (player.isHost) {
                const hostBadge = document.createElement('span');
                hostBadge.className = 'host-badge';
                hostBadge.textContent = 'ğŸ‘‘ Ù…Ø¶ÙŠÙ';
                badgeContainer.appendChild(hostBadge);
            }
            
            if (player.team) {
                const teamBadge = document.createElement('span');
                teamBadge.className = 'team-badge ' + player.team;
                teamBadge.textContent = player.team === 'team1' ? roomData.team1Name : roomData.team2Name;
                badgeContainer.appendChild(teamBadge);
            }
            
            div.appendChild(nameSpan);
            div.appendChild(badgeContainer);
            playersListContainer.appendChild(div);
        });

        if (currentTeam) {
            const team1Btn = document.getElementById('hostTeam1Btn');
            const team2Btn = document.getElementById('hostTeam2Btn');
            
            if (team1Btn && team2Btn) {
                if (currentTeam === 'team1') {
                    team1Btn.style.opacity = '1';
                    team1Btn.style.transform = 'scale(1.05)';
                    team2Btn.style.opacity = '0.6';
                    team2Btn.style.transform = 'scale(1)';
                } else {
                    team2Btn.style.opacity = '1';
                    team2Btn.style.transform = 'scale(1.05)';
                    team1Btn.style.opacity = '0.6';
                    team1Btn.style.transform = 'scale(1)';
                }
            }
        }

        const startBtn = document.getElementById('startGameBtn');
        if (playerCount >= requiredPlayers && currentTeam) {
            startBtn.disabled = false;
            startBtn.textContent = 'Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø© â–¶ï¸';
        } else if (!currentTeam) {
            startBtn.disabled = true;
            startBtn.textContent = 'Ø§Ø®ØªØ± ÙØ±ÙŠÙ‚Ùƒ Ø£ÙˆÙ„Ø§Ù‹';
        } else {
            startBtn.disabled = true;
            startBtn.textContent = `Ø¨Ø­Ø§Ø¬Ø© Ø¥Ù„Ù‰ ${requiredPlayers - playerCount} Ù„Ø§Ø¹Ø¨ÙŠÙ†`;
        }
    }

    function showTeamSelection() {
        hideAllScreens();
        document.getElementById('teamSelectionScreen').classList.add('active');
        document.getElementById('welcomePlayerName').textContent = currentPlayerName;
    }

    function updateTeamSelection() {
        const teamButtons = document.getElementById('teamButtons');
        teamButtons.innerHTML = '';

        const team1Btn = document.createElement('button');
        team1Btn.className = 'btn';
        team1Btn.textContent = 'ğŸ”´ ' + roomData.team1Name;
        team1Btn.onclick = () => selectTeam('team1');
        teamButtons.appendChild(team1Btn);

        const team2Btn = document.createElement('button');
        team2Btn.className = 'btn secondary';
        team2Btn.textContent = 'ğŸ”µ ' + roomData.team2Name;
        team2Btn.onclick = () => selectTeam('team2');
        teamButtons.appendChild(team2Btn);
    }

    function selectTeam(team) {
        currentTeam = team;
        database.ref('rooms/' + currentRoomCode + '/players/' + currentPlayerId).update({ team: team });
        
        if (roomData.gameState === 'playing') {
            showPlayerGameScreen();
        } else {
            showWaitingScreen();
        }
    }

    function selectHostTeam(team) {
        currentTeam = team;
        database.ref('rooms/' + currentRoomCode + '/players/' + currentPlayerId).update({ team: team });

        const team1Btn = document.getElementById('hostTeam1Btn');
        const team2Btn = document.getElementById('hostTeam2Btn');
        
        if (team === 'team1') {
            team1Btn.style.opacity = '1';
            team1Btn.style.transform = 'scale(1.05)';
            team2Btn.style.opacity = '0.6';
            team2Btn.style.transform = 'scale(1)';
        } else {
            team2Btn.style.opacity = '1';
            team2Btn.style.transform = 'scale(1.05)';
            team1Btn.style.opacity = '0.6';
            team1Btn.style.transform = 'scale(1)';
        }
    }

    function showWaitingScreen() {
        hideAllScreens();
        document.getElementById('waitingScreen').classList.add('active');
        const teamName = currentTeam === 'team1' ? roomData.team1Name : roomData.team2Name;
        document.getElementById('playerTeamName').textContent = teamName;
    }

    function updateWaitingScreen() {
        const players = roomData.players || {};
        const waitingPlayersListContainer = document.getElementById('waitingPlayersListContainer');
        waitingPlayersListContainer.innerHTML = '';

        Object.entries(players).forEach(([id, player]) => {
            const div = document.createElement('div');
            div.className = 'player-item';
            
            const nameSpan = document.createElement('span');
            nameSpan.className = 'player-name';
            nameSpan.textContent = player.name;
            
            const badgeContainer = document.createElement('div');
            
            if (player.isHost) {
                const hostBadge = document.createElement('span');
                hostBadge.className = 'host-badge';
                hostBadge.textContent = 'ğŸ‘‘';
                badgeContainer.appendChild(hostBadge);
            }
            
            if (player.team) {
                const teamBadge = document.createElement('span');
                teamBadge.className = 'team-badge ' + player.team;
                teamBadge.textContent = player.team === 'team1' ? roomData.team1Name : roomData.team2Name;
                badgeContainer.appendChild(teamBadge);
            }
            
            div.appendChild(nameSpan);
            div.appendChild(badgeContainer);
            waitingPlayersListContainer.appendChild(div);
        });
    }

    function startGame() {
        if (!currentTeam) {
            alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± ÙØ±ÙŠÙ‚Ùƒ Ø£ÙˆÙ„Ø§Ù‹');
            return;
        }

        database.ref('rooms/' + currentRoomCode).update({ gameState: 'playing' });
        showPlayerGameScreen();
    }

    function showPlayerGameScreen() {
        hideAllScreens();
        document.getElementById('playerGameScreen').classList.add('active');
    }

    function updatePlayerGameScreen() {
        if (!document.getElementById('playerGameScreen').classList.contains('active')) {
            showPlayerGameScreen();
        }

        updateTeamsPlayersDisplay();

        if (isHost) {
            document.getElementById('hostControlsPlayer').style.display = 'block';
        } else {
            document.getElementById('hostControlsPlayer').style.display = 'none';
        }

        const buzzButton = document.getElementById('buzzButton');
        const playerAnswerOptions = document.getElementById('playerAnswerOptions');
        const playerChoiceButtons = document.getElementById('playerChoiceButtons');
        const playerStatus = document.getElementById('playerStatus');
        const playerQuestionDisplay = document.getElementById('playerQuestionDisplay');
        const playerQuestionText = document.getElementById('playerQuestionText');
        const playerTimer = document.getElementById('playerTimer');
        const buzzerIndicator = document.getElementById('buzzerIndicator');
        const gameElements = document.getElementById('gameElements');
        const onCouchMessage = document.getElementById('onCouchMessage');
        const answerInputContainer = document.getElementById('answerInputContainer');

        const isOnCouch = (currentTeam === 'team1' && roomData.team1Couch?.includes(currentPlayerId)) ||
                         (currentTeam === 'team2' && roomData.team2Couch?.includes(currentPlayerId));

        if (isOnCouch) {
            gameElements.style.display = 'none';
            onCouchMessage.style.display = 'block';
            checkVictory();
            return;
        } else {
            gameElements.style.display = 'block';
            onCouchMessage.style.display = 'none';
        }

        if (roomData.currentQuestion) {
            playerQuestionDisplay.style.display = 'block';
            playerQuestionText.textContent = roomData.currentQuestion.question;
            
            if (roomData.questionStartTime && !roomData.showOptions && !roomData.waitingForTextAnswer) {
                const elapsed = Math.floor((Date.now() - roomData.questionStartTime) / 1000);
                const timeLeft = Math.max(0, 30 - elapsed);
                playerTimer.style.display = 'block';
                playerTimer.textContent = timeLeft;
                
                if (timeLeft <= 3) {
                    playerTimer.classList.add('warning');
                } else {
                    playerTimer.classList.remove('warning');
                }
            } else {
                playerTimer.style.display = 'none';
            }
        } else {
            playerQuestionDisplay.style.display = 'none';
            playerTimer.style.display = 'none';
        }

        if (roomData.buzzedPlayer && !roomData.showOptions && !roomData.correctAnswer) {
            const player = roomData.players[roomData.buzzedPlayer];
            const team = player.team === 'team1' ? roomData.team1Name : roomData.team2Name;
            buzzerIndicator.innerHTML = `<div class="buzzer-indicator">ğŸ”” ${player.name} Ù…Ù† ${team} ÙŠÙƒØªØ¨ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©...</div>`;
        } else {
            buzzerIndicator.innerHTML = '';
        }

        if (roomData.waitingForTextAnswer && roomData.buzzedPlayer === currentPlayerId && !roomData.correctAnswer) {
            playerStatus.textContent = 'Ø§ÙƒØªØ¨ Ø¥Ø¬Ø§Ø¨ØªÙƒ Ø¨Ø³Ø±Ø¹Ø©! (5 Ø«ÙˆØ§Ù†ÙŠ)';
            playerStatus.className = 'status-message warning';
            buzzButton.style.display = 'none';
            answerInputContainer.style.display = 'block';
            playerAnswerOptions.innerHTML = '';
            playerChoiceButtons.innerHTML = '';
            
            const textInput = document.getElementById('textAnswerInput');
            if (textInput) {
                textInput.value = '';
                textInput.focus();
            }
            
            return;
        } else {
            answerInputContainer.style.display = 'none';
            buzzButton.style.display = 'block';
        }

        if (roomData.waitingForChoice && roomData.choicePlayer === currentPlayerId) {
            playerStatus.textContent = 'Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! Ø§Ø®ØªØ±:';
            playerStatus.className = 'status-message success';
            buzzButton.disabled = true;
            playerAnswerOptions.innerHTML = '';
            
            const otherTeam = currentTeam === 'team1' ? 'team2' : 'team1';
            const myTeam = currentTeam;
            const teamSize = roomData.teamSize || 2;
            
            const myCouch = roomData[myTeam + 'Couch'] || [];
            const otherCouch = roomData[otherTeam + 'Couch'] || [];
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª ÙƒÙ†Ø¨Ø© ÙØ±ÙŠÙ‚ÙŠ Ù…Ù…ØªÙ„Ø¦Ø©
            const myCouchFull = myCouch.length >= teamSize;
            const hasOtherCouch = otherCouch.length > 0;
            
            playerChoiceButtons.innerHTML = '';
            
            // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª ÙƒÙ†Ø¨Ø© ÙØ±ÙŠÙ‚ÙŠ Ù…Ù…ØªÙ„Ø¦Ø©ØŒ Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„ÙˆØ­ÙŠØ¯ Ù‡Ùˆ Ø³Ø±Ù‚Ø© Ù„Ø§Ø¹Ø¨ Ù…Ù† Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø¢Ø®Ø±
            if (myCouchFull && hasOtherCouch) {
                playerStatus.textContent = 'ÙƒÙ†Ø¨Ø© ÙØ±ÙŠÙ‚Ùƒ Ù…Ù…ØªÙ„Ø¦Ø©! ÙŠØ¬Ø¨ Ø³Ø­Ø¨ Ù„Ø§Ø¹Ø¨ Ù…Ù† Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø¢Ø®Ø±';
                playerStatus.className = 'status-message warning';
                
                const stealBtn = document.createElement('button');
                stealBtn.className = 'choice-btn steal';
                stealBtn.textContent = 'ğŸ¯ Ø§Ø³Ø­Ø¨ Ù„Ø§Ø¹Ø¨ Ù…Ù† Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø¢Ø®Ø±';
                stealBtn.onclick = () => makeChoice('steal');
                playerChoiceButtons.appendChild(stealBtn);
            } else if (!myCouchFull) {
                // Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† ÙƒÙ†Ø¨Ø© ÙØ±ÙŠÙ‚ÙŠ Ù…Ù…ØªÙ„Ø¦Ø©ØŒ Ø§Ø¹Ø±Ø¶ Ø®ÙŠØ§Ø± Ø§Ù„Ø¬Ù„ÙˆØ³
                const sitBtn = document.createElement('button');
                sitBtn.className = 'choice-btn sit';
                sitBtn.textContent = 'ğŸ›‹ï¸ Ø§Ø¬Ù„Ø³ Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ†Ø¨Ø©';
                sitBtn.onclick = () => makeChoice('sit');
                playerChoiceButtons.appendChild(sitBtn);
                
                // ÙˆØ§Ø¹Ø±Ø¶ Ø®ÙŠØ§Ø± Ø§Ù„Ø³Ø±Ù‚Ø© Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ù„Ø§Ø¹Ø¨ÙˆÙ† Ø¹Ù„Ù‰ ÙƒÙ†Ø¨Ø© Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø¢Ø®Ø±
                if (hasOtherCouch) {
                    const stealBtn = document.createElement('button');
                    stealBtn.className = 'choice-btn steal';
                    stealBtn.textContent = 'ğŸ¯ Ø§Ø³Ø­Ø¨ Ù„Ø§Ø¹Ø¨ Ù…Ù† Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø¢Ø®Ø±';
                    stealBtn.onclick = () => makeChoice('steal');
                    playerChoiceButtons.appendChild(stealBtn);
                }
            }
            
            return;
        } else {
            playerChoiceButtons.innerHTML = '';
        }

        const playerTeam = roomData.players[currentPlayerId]?.team;
        
        // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ù…ÙØªÙˆØ­Ø© ÙˆÙ‡Ù†Ø§Ùƒ ÙØ±ÙŠÙ‚ Ù…Ø­Ø¸ÙˆØ±
        if (roomData.showOptions && roomData.bannedTeam && roomData.bannedTeam !== playerTeam && !roomData.correctAnswer) {
            playerStatus.textContent = 'ÙØ±ØµØ© ÙØ±ÙŠÙ‚Ùƒ! Ø§Ø®ØªØ± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©';
            playerStatus.className = 'status-message info';
            buzzButton.disabled = true;
            
            playerAnswerOptions.innerHTML = '';
            roomData.currentQuestion.options.forEach((option, index) => {
                const btn = document.createElement('button');
                btn.className = 'answer-btn';
                btn.textContent = option;
                btn.onclick = () => selectAnswer(index);
                playerAnswerOptions.appendChild(btn);
            });
            return;
        } else if (roomData.showOptions && roomData.bannedTeam === playerTeam && !roomData.correctAnswer) {
            playerStatus.textContent = 'ÙØ±ÙŠÙ‚Ùƒ Ù…Ù…Ù†ÙˆØ¹ Ù…Ù† Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© - Ø§Ù†ØªØ¸Ø± Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ';
            playerStatus.className = 'status-message error';
            buzzButton.disabled = true;
            playerAnswerOptions.innerHTML = '';
            return;
        } else if (roomData.showOptions && !roomData.bannedTeam && !roomData.correctAnswer) {
            // Ù„Ù… ÙŠØ¶ØºØ· Ø£Ø­Ø¯ Ø§Ù„Ø¬Ø±Ø³ ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø­Ø¯Ø¯ - ÙØªØ­ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ù„Ù„Ø¬Ù…ÙŠØ¹
            playerStatus.textContent = 'Ù„Ù… ÙŠØ¶ØºØ· Ø£Ø­Ø¯ Ø§Ù„Ø¬Ø±Ø³! Ø§Ø®ØªØ± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©';
            playerStatus.className = 'status-message info';
            buzzButton.disabled = true;
            
            playerAnswerOptions.innerHTML = '';
            roomData.currentQuestion.options.forEach((option, index) => {
                const btn = document.createElement('button');
                btn.className = 'answer-btn';
                btn.textContent = option;
                btn.onclick = () => selectAnswer(index);
                playerAnswerOptions.appendChild(btn);
            });
            return;
        }

        if (roomData.correctAnswer !== null && roomData.buzzedPlayer === currentPlayerId) {
            playerAnswerOptions.innerHTML = '';
            buzzButton.disabled = true;
            
            if (roomData.correctAnswer) {
                playerStatus.textContent = 'âœ… Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©!';
                playerStatus.className = 'status-message success';
            } else {
                playerStatus.textContent = 'âŒ Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©!';
                playerStatus.className = 'status-message error';
            }
            return;
        }

        if (roomData.currentQuestion && !roomData.buzzedPlayer && !roomData.showOptions) {
            playerStatus.textContent = 'Ø§Ø¶ØºØ· Ø§Ù„Ø¬Ø±Ø³ Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø©!';
            playerStatus.className = 'status-message info';
            buzzButton.disabled = false;
            playerAnswerOptions.innerHTML = '';
        } else if (roomData.buzzedPlayer && roomData.buzzedPlayer !== currentPlayerId) {
            const buzzedPlayerData = roomData.players[roomData.buzzedPlayer];
            playerStatus.textContent = `${buzzedPlayerData.name} ÙŠØ¬ÙŠØ¨ Ø§Ù„Ø¢Ù†...`;
            playerStatus.className = 'status-message warning';
            buzzButton.disabled = true;
            playerAnswerOptions.innerHTML = '';
        } else if (!roomData.currentQuestion) {
            playerStatus.textContent = 'Ø§Ù†ØªØ¸Ø± Ø§Ù„Ø³Ø¤Ø§Ù„...';
            playerStatus.className = 'status-message info';
            buzzButton.disabled = true;
            playerAnswerOptions.innerHTML = '';
            
            if (isHost) {
                const nextBtn = document.getElementById('nextQuestionBtnPlayer');
                if (nextBtn) nextBtn.disabled = false;
            }
        }

        checkVictory();
    }

    function updateTeamsPlayersDisplay() {
        if (!roomData || !roomData.players) return;

        document.getElementById('playerTeam1Name').textContent = roomData.team1Name;
        document.getElementById('playerTeam2Name').textContent = roomData.team2Name;
        document.getElementById('playerCouchTeam1').textContent = roomData.team1Name;
        document.getElementById('playerCouchTeam2').textContent = roomData.team2Name;

        const team1Players = [];
        const team2Players = [];

        Object.entries(roomData.players).forEach(([id, player]) => {
            if (player.team === 'team1') {
                team1Players.push({ id, ...player });
            } else if (player.team === 'team2') {
                team2Players.push({ id, ...player });
            }
        });

        const team1List = document.getElementById('team1PlayersList');
        team1List.innerHTML = '';
        team1Players.forEach(player => {
            const div = document.createElement('div');
            div.className = 'player-name-tag';
            if (roomData.team1Couch?.includes(player.id)) {
                div.classList.add('on-couch');
            }
            div.textContent = player.name;
            team1List.appendChild(div);
        });

        const team2List = document.getElementById('team2PlayersList');
        team2List.innerHTML = '';
        team2Players.forEach(player => {
            const div = document.createElement('div');
            div.className = 'player-name-tag';
            if (roomData.team2Couch?.includes(player.id)) {
                div.classList.add('on-couch');
            }
            div.textContent = player.name;
            team2List.appendChild(div);
        });

        const team1Couch = document.getElementById('playerTeam1Couch');
        const team2Couch = document.getElementById('playerTeam2Couch');

        team1Couch.innerHTML = '';
        if (roomData.team1Couch && roomData.team1Couch.length > 0) {
            roomData.team1Couch.forEach(playerId => {
                const player = roomData.players[playerId];
                if (player) {
                    const div = document.createElement('div');
                    div.className = 'couch-player';
                    div.textContent = 'ğŸ† ' + player.name;
                    team1Couch.appendChild(div);
                }
            });
        } else {
            team1Couch.innerHTML = '<div class="couch-empty">ÙØ§Ø±ØºØ©</div>';
        }

        team2Couch.innerHTML = '';
        if (roomData.team2Couch && roomData.team2Couch.length > 0) {
            roomData.team2Couch.forEach(playerId => {
                const player = roomData.players[playerId];
                if (player) {
                    const div = document.createElement('div');
                    div.className = 'couch-player';
                    div.textContent = 'ğŸ† ' + player.name;
                    team2Couch.appendChild(div);
                }
            });
        } else {
            team2Couch.innerHTML = '<div class="couch-empty">ÙØ§Ø±ØºØ©</div>';
        }
    }

    function nextQuestion() {
        clearInterval(timerInterval);
        clearInterval(answerTimerInterval);

        const usedQuestions = roomData.usedQuestions || [];
        let availableQuestions = questions.filter(q => !usedQuestions.includes(q.question));
        
        if (availableQuestions.length === 0) {
            availableQuestions = questions;
            usedQuestions.length = 0;
        }

        const randomQuestion = availableQuestions[Math.floor(Math.random() * availableQuestions.length)];
        usedQuestions.push(randomQuestion.question);

        database.ref('rooms/' + currentRoomCode).update({
            currentQuestion: randomQuestion,
            usedQuestions: usedQuestions,
            buzzedPlayer: null,
            showOptions: false,
            bannedTeam: null,
            correctAnswer: null,
            selectedAnswer: null,
            waitingForChoice: false,
            choicePlayer: null,
            questionStartTime: Date.now(),
            waitingForTextAnswer: false
        });

        const nextBtn = document.getElementById('nextQuestionBtnPlayer');
        if (nextBtn) nextBtn.disabled = true;

        startTimer(30);
    }

    function startTimer(seconds) {
        clearInterval(timerInterval);
        let timeLeft = seconds;
        
        const playerTimerElement = document.getElementById('playerTimer');
        
        if (playerTimerElement) {
            playerTimerElement.style.display = 'block';
            playerTimerElement.textContent = timeLeft;
            playerTimerElement.classList.remove('warning');
        }

        timerInterval = setInterval(() => {
            timeLeft--;
            
            if (playerTimerElement) {
                playerTimerElement.textContent = timeLeft;
                if (timeLeft <= 3) {
                    playerTimerElement.classList.add('warning');
                }
            }

            if (timeLeft <= 0) {
                clearInterval(timerInterval);
                
                if (!roomData.buzzedPlayer && !roomData.showOptions) {
                    database.ref('rooms/' + currentRoomCode).update({ 
                        showOptions: true,
                        bannedTeam: null
                    });
                    
                    if (isHost) {
                        setTimeout(() => {
                            const nextBtn = document.getElementById('nextQuestionBtnPlayer');
                            if (nextBtn) nextBtn.disabled = false;
                        }, 2000);
                    }
                }
            }
        }, 1000);
    }

    function buzzIn() {
        if (!roomData.currentQuestion || roomData.buzzedPlayer || roomData.showOptions) return;

        database.ref('rooms/' + currentRoomCode).update({
            buzzedPlayer: currentPlayerId,
            waitingForTextAnswer: true,
            questionStartTime: Date.now()
        });

        clearInterval(timerInterval);
        startAnswerTimer(5);
    }

    function startAnswerTimer(seconds) {
        clearInterval(answerTimerInterval);
        let timeLeft = seconds;
        
        const answerTimerElement = document.getElementById('answerTimer');
        if (answerTimerElement) {
            answerTimerElement.style.display = 'block';
            answerTimerElement.textContent = timeLeft;
            answerTimerElement.classList.remove('warning');
        }
        
        answerTimerInterval = setInterval(() => {
            timeLeft--;
            
            if (answerTimerElement) {
                answerTimerElement.textContent = timeLeft;
                if (timeLeft <= 2) {
                    answerTimerElement.classList.add('warning');
                }
            }

            if (timeLeft <= 0) {
                clearInterval(answerTimerInterval);
                
                if (roomData.buzzedPlayer === currentPlayerId && roomData.correctAnswer === null) {
                    const playerTeam = roomData.players[currentPlayerId]?.team;
                    database.ref('rooms/' + currentRoomCode).update({
                        correctAnswer: false,
                        waitingForTextAnswer: false,
                        showOptions: true,
                        bannedTeam: playerTeam
                    });
                }
            }
        }, 1000);
    }

    function submitTextAnswer() {
        const textInput = document.getElementById('textAnswerInput');
        const userAnswer = textInput.value.trim().toLowerCase();
        
        if (!userAnswer) {
            alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ ÙƒØªØ§Ø¨Ø© Ø¥Ø¬Ø§Ø¨Ø©!');
            return;
        }

        clearInterval(answerTimerInterval);
        
        const answerTimerElement = document.getElementById('answerTimer');
        if (answerTimerElement) {
            answerTimerElement.style.display = 'none';
        }

        const correctOption = roomData.currentQuestion.options[roomData.currentQuestion.correct];
        const correctAnswer = correctOption.toLowerCase();
        
        const isCorrect = userAnswer === correctAnswer || 
                         correctAnswer.includes(userAnswer) || 
                         userAnswer.includes(correctAnswer.split(' ')[0]);

        const roomRef = database.ref('rooms/' + currentRoomCode);
        
        if (isCorrect) {
            roomRef.update({
                correctAnswer: true,
                waitingForTextAnswer: false
            });

            const otherTeam = currentTeam === 'team1' ? 'team2' : 'team1';
            const hasOtherCouch = roomData[otherTeam + 'Couch']?.length > 0;
            
            if (hasOtherCouch) {
                roomRef.update({
                    waitingForChoice: true,
                    choicePlayer: currentPlayerId
                });
            } else {
                addToCouch();
            }
        } else {
            const playerTeam = roomData.players[currentPlayerId]?.team;
            roomRef.update({
                correctAnswer: false,
                waitingForTextAnswer: false,
                showOptions: true,
                bannedTeam: playerTeam
            });
        }
    }

    function selectAnswer(answerIndex) {
        const isCorrect = answerIndex === roomData.currentQuestion.correct;

        database.ref('rooms/' + currentRoomCode).update({
            selectedAnswer: answerIndex,
            correctAnswer: isCorrect
        });

        clearInterval(timerInterval);

        if (isCorrect) {
            const otherTeam = currentTeam === 'team1' ? 'team2' : 'team1';
            const hasOtherCouch = roomData[otherTeam + 'Couch']?.length > 0;
            
            if (hasOtherCouch) {
                database.ref('rooms/' + currentRoomCode).update({
                    waitingForChoice: true,
                    choicePlayer: currentPlayerId,
                    bannedTeam: null
                });
            } else {
                addToCouch();
                database.ref('rooms/' + currentRoomCode).update({ bannedTeam: null });
            }
        } else {
            database.ref('rooms/' + currentRoomCode).update({
                showOptions: false,
                bannedTeam: null
            });
            
            if (isHost) {
                setTimeout(() => {
                    const nextBtn = document.getElementById('nextQuestionBtnPlayer');
                    if (nextBtn) nextBtn.disabled = false;
                }, 2000);
            }
        }
    }

    function makeChoice(choice) {
        if (choice === 'sit') {
            addToCouch();
        } else if (choice === 'steal') {
            stealFromCouch();
        }
    }

    function addToCouch() {
        const couchKey = currentTeam + 'Couch';
        const scoreKey = currentTeam + 'Score';
        const teamSize = roomData.teamSize || 2;
        
        const currentCouch = roomData[couchKey] || [];
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ØªØ¬Ø§ÙˆØ² Ø­Ø¬Ù… Ø§Ù„ÙØ±ÙŠÙ‚
        if (currentCouch.length >= teamSize) {
            console.log('Ø§Ù„ÙƒÙ†Ø¨Ø© Ù…Ù…ØªÙ„Ø¦Ø©! Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†.');
            database.ref('rooms/' + currentRoomCode).update({
                waitingForChoice: false,
                choicePlayer: null
            });
            return;
        }
        
        const newCouch = [...currentCouch, currentPlayerId];
        const newScore = (roomData[scoreKey] || 0) + 1;

        database.ref('rooms/' + currentRoomCode).update({
            [couchKey]: newCouch,
            [scoreKey]: newScore,
            waitingForChoice: false,
            choicePlayer: null
        });

        if (isHost) {
            setTimeout(() => {
                const nextBtn = document.getElementById('nextQuestionBtnPlayer');
                if (nextBtn) nextBtn.disabled = false;
            }, 1000);
        }
    }

    function stealFromCouch() {
        const otherTeam = currentTeam === 'team1' ? 'team2' : 'team1';
        const otherCouchKey = otherTeam + 'Couch';
        const couchKey = currentTeam + 'Couch';
        const scoreKey = currentTeam + 'Score';
        const otherScoreKey = otherTeam + 'Score';
        const teamSize = roomData.teamSize || 2;
        
        const otherCouch = [...(roomData[otherCouchKey] || [])];
        const myCouch = [...(roomData[couchKey] || [])];
        
        // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ Ù„Ø§Ø¹Ø¨ÙˆÙ† Ø¹Ù„Ù‰ ÙƒÙ†Ø¨Ø© Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø¢Ø®Ø±
        if (otherCouch.length === 0) {
            console.log('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù„Ø§Ø¹Ø¨ÙˆÙ† Ø¹Ù„Ù‰ ÙƒÙ†Ø¨Ø© Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø¢Ø®Ø± Ù„Ù„Ø³Ø±Ù‚Ø©');
            database.ref('rooms/' + currentRoomCode).update({
                waitingForChoice: false,
                choicePlayer: null
            });
            return;
        }
        
        // Ø³Ø­Ø¨ Ø¢Ø®Ø± Ù„Ø§Ø¹Ø¨ Ù…Ù† ÙƒÙ†Ø¨Ø© Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø¢Ø®Ø± (Ø¥Ø¹Ø§Ø¯ØªÙ‡ Ø¥Ù„Ù‰ Ø§Ù„Ù„Ø¹Ø¨Ø©)
        const stolenPlayer = otherCouch.pop();
        const otherNewScore = Math.max(0, (roomData[otherScoreKey] || 0) - 1);
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª ÙƒÙ†Ø¨Ø© ÙØ±ÙŠÙ‚ÙŠ Ù…Ù…ØªÙ„Ø¦Ø©
        if (myCouch.length >= teamSize) {
            // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…Ù…ØªÙ„Ø¦Ø©ØŒ ÙÙ‚Ø· Ø£Ø¹Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø¢Ø®Ø± Ø¥Ù„Ù‰ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¯ÙˆÙ† Ø§Ù„Ø¬Ù„ÙˆØ³
            database.ref('rooms/' + currentRoomCode).update({
                [otherCouchKey]: otherCouch,
                [otherScoreKey]: otherNewScore,
                waitingForChoice: false,
                choicePlayer: null
            });
        } else {
            // Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…Ù…ØªÙ„Ø¦Ø©ØŒ Ø§Ø¬Ù„Ø³ Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ†Ø¨Ø© ÙˆØ£Ø¹Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø¢Ø®Ø±
            const newCouch = [...myCouch, currentPlayerId];
            const newScore = (roomData[scoreKey] || 0) + 1;

            database.ref('rooms/' + currentRoomCode).update({
                [couchKey]: newCouch,
                [otherCouchKey]: otherCouch,
                [scoreKey]: newScore,
                [otherScoreKey]: otherNewScore,
                waitingForChoice: false,
                choicePlayer: null
            });
        }

        if (isHost) {
            setTimeout(() => {
                const nextBtn = document.getElementById('nextQuestionBtnPlayer');
                if (nextBtn) nextBtn.disabled = false;
            }, 1000);
        }
    }

    function checkVictory() {
        const teamSize = roomData.teamSize || 2;
        
        if (roomData.team1Couch?.length >= teamSize) {
            showVictory(roomData.team1Name);
        } else if (roomData.team2Couch?.length >= teamSize) {
            showVictory(roomData.team2Name);
        }
    }

    function showVictory(teamName) {
        clearInterval(timerInterval);
        clearInterval(answerTimerInterval);
        
        const victoryScreenPlayer = document.getElementById('victoryScreenPlayer');
        if (victoryScreenPlayer) {
            victoryScreenPlayer.style.display = 'block';
            document.getElementById('victoryMessagePlayer').textContent = `ğŸ‰ ${teamName} ÙØ§Ø² Ø¨Ø§Ù„Ù„Ø¹Ø¨Ø©! ğŸ‰`;
            
            document.getElementById('teamsPlayersDisplay').style.display = 'none';
            document.getElementById('gameElements').style.display = 'none';
            document.getElementById('hostControlsPlayer').style.display = 'none';
            document.getElementById('onCouchMessage').style.display = 'none';
            
            const couchDisplay = document.querySelector('.couch-display-player');
            if (couchDisplay) couchDisplay.style.display = 'none';
        }
        
        const nextBtnPlayer = document.getElementById('nextQuestionBtnPlayer');
        if (nextBtnPlayer) nextBtnPlayer.style.display = 'none';
    }

    document.getElementById('roomCode')?.addEventListener('input', function(e) {
        this.value = this.value.replace(/[^0-9]/g, '');
    });

    document.getElementById('textAnswerInput')?.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            submitTextAnswer();
        }
    });
</script>
```

</body>
</html>
