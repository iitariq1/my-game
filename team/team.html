<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„Ø¹Ø¨Ø© Ø§Ù„ÙØ±Ù‚ - Ø£Ø³Ø¦Ù„Ø© ÙˆØ£Ø¬ÙˆØ¨Ø©</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 1400px;
            width: 100%;
            padding: 40px;
        }

        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .setup-screen, .game-screen {
            display: none;
        }

        .setup-screen.active, .game-screen.active {
            display: block;
        }

        .team-setup {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .team-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            padding: 30px;
            border-radius: 15px;
            color: white;
        }

        .team-card.team2 {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .team-card h2 {
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .input-group input, .input-group select {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
        }

        .players-container {
            margin-top: 15px;
        }

        .player-input {
            margin-bottom: 10px;
        }

        .start-btn {
            display: block;
            width: 300px;
            margin: 30px auto;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .start-btn:hover {
            transform: scale(1.05);
        }

        .game-board {
            display: grid;
            grid-template-columns: 1fr 2fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }

        .team-panel {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
        }

        .team-panel h3 {
            margin-bottom: 20px;
            color: #667eea;
            font-size: 1.5em;
        }

        .player-btn {
            width: 100%;
            padding: 15px;
            margin-bottom: 10px;
            border: 3px solid #667eea;
            background: white;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .player-btn:hover:not(:disabled) {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
        }

        .player-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .player-btn.winner {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border-color: #f5576c;
        }

        .player-btn.winner::after {
            content: "ğŸ†";
            position: absolute;
            left: 10px;
        }

        .question-panel {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .question-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .timer {
            font-size: 3em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 20px;
        }

        .timer.warning {
            color: #f5576c;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .question-text {
            font-size: 1.5em;
            color: #333;
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .options-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }

        .option-btn {
            padding: 20px;
            border: 3px solid #ddd;
            background: white;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
        }

        .option-btn:hover {
            border-color: #667eea;
            background: #f8f9fa;
            transform: translateY(-2px);
        }

        .option-btn.correct {
            background: #4caf50;
            color: white;
            border-color: #4caf50;
        }

        .option-btn.incorrect {
            background: #f44336;
            color: white;
            border-color: #f44336;
        }

        .status-message {
            text-align: center;
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            font-size: 1.2em;
            font-weight: bold;
        }

        .status-message.info {
            background: #e3f2fd;
            color: #1976d2;
        }

        .status-message.success {
            background: #e8f5e9;
            color: #388e3c;
        }

        .status-message.error {
            background: #ffebee;
            color: #d32f2f;
        }

        .winner-seats {
            margin-top: 20px;
            padding: 15px;
            background: #fff3e0;
            border-radius: 10px;
        }

        .winner-seats h4 {
            color: #f57c00;
            margin-bottom: 10px;
        }

        .winner-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .winner-badge {
            padding: 8px 15px;
            background: linear-gradient(135deg, #ffd89b 0%, #19547b 100%);
            color: white;
            border-radius: 20px;
            font-weight: bold;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }

        .action-btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .action-btn.join {
            background: linear-gradient(135deg, #4caf50 0%, #45a049 100%);
            color: white;
        }

        .action-btn.steal {
            background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);
            color: white;
        }

        .action-btn:hover {
            transform: scale(1.05);
        }

        .victory-screen {
            display: none;
            text-align: center;
            padding: 50px;
        }

        .victory-screen.active {
            display: block;
        }

        .victory-screen h2 {
            font-size: 3em;
            color: #667eea;
            margin-bottom: 30px;
        }

        .confetti {
            font-size: 5em;
            margin-bottom: 20px;
        }

        .score-display {
            display: flex;
            justify-content: space-around;
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
        }

        .team-score {
            text-align: center;
        }

        .team-score h3 {
            font-size: 1.5em;
            margin-bottom: 10px;
        }

        .team-score .score {
            font-size: 3em;
            font-weight: bold;
            color: #667eea;
        }

        .waiting-message {
            text-align: center;
            padding: 20px;
            background: #e3f2fd;
            border-radius: 10px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ® Ù„Ø¹Ø¨Ø© Ø§Ù„ÙØ±Ù‚ - Ø£Ø³Ø¦Ù„Ø© ÙˆØ£Ø¬ÙˆØ¨Ø© ğŸ®</h1>

        <!-- Setup Screen -->
        <div class="setup-screen active">
            <div class="team-setup">
                <div class="team-card team1">
                    <h2>Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£ÙˆÙ„</h2>
                    <div class="input-group">
                        <label>Ø§Ø³Ù… Ø§Ù„ÙØ±ÙŠÙ‚:</label>
                        <input type="text" id="team1Name" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„ÙØ±ÙŠÙ‚">
                    </div>
                    <div class="input-group">
                        <label>Ø¹Ø¯Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†:</label>
                        <select id="team1Count">
                            <option value="2">2 Ù„Ø§Ø¹Ø¨ÙŠÙ†</option>
                            <option value="3">3 Ù„Ø§Ø¹Ø¨ÙŠÙ†</option>
                            <option value="4">4 Ù„Ø§Ø¹Ø¨ÙŠÙ†</option>
                            <option value="5">5 Ù„Ø§Ø¹Ø¨ÙŠÙ†</option>
                        </select>
                    </div>
                    <div class="players-container" id="team1Players"></div>
                </div>

                <div class="team-card team2">
                    <h2>Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø«Ø§Ù†ÙŠ</h2>
                    <div class="input-group">
                        <label>Ø§Ø³Ù… Ø§Ù„ÙØ±ÙŠÙ‚:</label>
                        <input type="text" id="team2Name" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„ÙØ±ÙŠÙ‚">
                    </div>
                    <div class="input-group">
                        <label>Ø¹Ø¯Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†:</label>
                        <select id="team2Count">
                            <option value="2">2 Ù„Ø§Ø¹Ø¨ÙŠÙ†</option>
                            <option value="3">3 Ù„Ø§Ø¹Ø¨ÙŠÙ†</option>
                            <option value="4">4 Ù„Ø§Ø¹Ø¨ÙŠÙ†</option>
                            <option value="5">5 Ù„Ø§Ø¹Ø¨ÙŠÙ†</option>
                        </select>
                    </div>
                    <div class="players-container" id="team2Players"></div>
                </div>
            </div>
            <button class="start-btn" onclick="startGame()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø© ğŸš€</button>
        </div>

        <!-- Game Screen -->
        <div class="game-screen">
            <div class="score-display">
                <div class="team-score">
                    <h3 id="displayTeam1Name">Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£ÙˆÙ„</h3>
                    <div class="score" id="team1Score">0</div>
                </div>
                <div class="team-score">
                    <h3 id="displayTeam2Name">Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø«Ø§Ù†ÙŠ</h3>
                    <div class="score" id="team2Score">0</div>
                </div>
            </div>

            <div class="game-board">
                <div class="team-panel">
                    <h3 id="team1PanelName">Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£ÙˆÙ„</h3>
                    <div id="team1Buttons"></div>
                    <div class="winner-seats">
                        <h4>ğŸ† Ù…Ù‚Ø§Ø¹Ø¯ Ø§Ù„ÙÙˆØ²</h4>
                        <div class="winner-list" id="team1Winners"></div>
                    </div>
                </div>

                <div class="question-panel">
                    <div class="question-header">
                        <div class="timer" id="timer">--</div>
                        <div class="question-text" id="questionText">Ø§Ù†ØªØ¸Ø± Ø§Ù„Ø³Ø¤Ø§Ù„...</div>
                    </div>
                    <div class="options-container" id="optionsContainer"></div>
                    <div class="status-message info" id="statusMessage">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø©!</div>
                    <div class="action-buttons" id="actionButtons"></div>
                </div>

                <div class="team-panel">
                    <h3 id="team2PanelName">Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø«Ø§Ù†ÙŠ</h3>
                    <div id="team2Buttons"></div>
                    <div class="winner-seats">
                        <h4>ğŸ† Ù…Ù‚Ø§Ø¹Ø¯ Ø§Ù„ÙÙˆØ²</h4>
                        <div class="winner-list" id="team2Winners"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Victory Screen -->
        <div class="victory-screen">
            <div class="confetti">ğŸ‰ğŸŠğŸ‰</div>
            <h2 id="victoryMessage">ÙØ§Ø² Ø§Ù„ÙØ±ÙŠÙ‚!</h2>
            <div class="confetti">ğŸ†ğŸ‘‘ğŸ†</div>
            <button class="start-btn" onclick="location.reload()">Ù„Ø¹Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</button>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, set, onValue, update, push } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBUXlgxP463b18dg9_Og_8EcMDLfLIr76o",
            authDomain: "team-cc63c.firebaseapp.com",
            databaseURL: "https://team-cc63c-default-rtdb.europe-west1.firebasedatabase.app/",
            projectId: "team-cc63c",
            storageBucket: "team-cc63c.firebasestorage.app",
            messagingSenderId: "511582595742",
            appId: "1:511582595742:web:3e21273dcf49bf26d7298f",
            measurementId: "G-PSDJ9N34PH"
        };

        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        // Questions Database
        const questions = [
            // Ø£Ø³Ø¦Ù„Ø© Ø¯ÙŠÙ†ÙŠØ©
            {category: "Ø¯ÙŠÙ†ÙŠØ©", question: "ÙƒÙ… Ø¹Ø¯Ø¯ Ø³ÙˆØ± Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…ØŸ", options: ["114 Ø³ÙˆØ±Ø©", "110 Ø³ÙˆØ±Ø©", "120 Ø³ÙˆØ±Ø©", "100 Ø³ÙˆØ±Ø©"], correct: 0},
            {category: "Ø¯ÙŠÙ†ÙŠØ©", question: "Ù…Ø§ Ù‡ÙŠ Ø£Ø·ÙˆÙ„ Ø³ÙˆØ±Ø© ÙÙŠ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…ØŸ", options: ["Ø³ÙˆØ±Ø© Ø§Ù„Ø¨Ù‚Ø±Ø©", "Ø³ÙˆØ±Ø© Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†", "Ø³ÙˆØ±Ø© Ø§Ù„Ù†Ø³Ø§Ø¡", "Ø³ÙˆØ±Ø© Ø§Ù„Ø£Ø¹Ø±Ø§Ù"], correct: 0},
            {category: "Ø¯ÙŠÙ†ÙŠØ©", question: "ÙƒÙ… Ø¹Ø¯Ø¯ Ø£Ø±ÙƒØ§Ù† Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ØŸ", options: ["5 Ø£Ø±ÙƒØ§Ù†", "4 Ø£Ø±ÙƒØ§Ù†", "6 Ø£Ø±ÙƒØ§Ù†", "7 Ø£Ø±ÙƒØ§Ù†"], correct: 0},
            {category: "Ø¯ÙŠÙ†ÙŠØ©", question: "Ù…Ù† Ù‡Ùˆ Ø®Ø§ØªÙ… Ø§Ù„Ø£Ù†Ø¨ÙŠØ§Ø¡ØŸ", options: ["Ù…Ø­Ù…Ø¯ ï·º", "Ø¹ÙŠØ³Ù‰ Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø³Ù„Ø§Ù…", "Ù…ÙˆØ³Ù‰ Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø³Ù„Ø§Ù…", "Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø³Ù„Ø§Ù…"], correct: 0},
            {category: "Ø¯ÙŠÙ†ÙŠØ©", question: "ÙÙŠ Ø£ÙŠ Ø´Ù‡Ø± ÙØ±Ø¶ Ø§Ù„ØµÙŠØ§Ù…ØŸ", options: ["Ø±Ù…Ø¶Ø§Ù†", "Ø´Ø¹Ø¨Ø§Ù†", "Ø±Ø¬Ø¨", "Ø°Ùˆ Ø§Ù„Ù‚Ø¹Ø¯Ø©"], correct: 0},
            {category: "Ø¯ÙŠÙ†ÙŠØ©", question: "ÙƒÙ… Ø¹Ø¯Ø¯ Ø§Ù„ØµÙ„ÙˆØ§Øª Ø§Ù„Ù…ÙØ±ÙˆØ¶Ø© ÙÙŠ Ø§Ù„ÙŠÙˆÙ…ØŸ", options: ["5 ØµÙ„ÙˆØ§Øª", "3 ØµÙ„ÙˆØ§Øª", "7 ØµÙ„ÙˆØ§Øª", "4 ØµÙ„ÙˆØ§Øª"], correct: 0},
            {category: "Ø¯ÙŠÙ†ÙŠØ©", question: "Ù…Ø§ Ù‡ÙŠ Ø£ÙˆÙ„ Ø³ÙˆØ±Ø© Ù†Ø²Ù„Øª ÙÙŠ Ø§Ù„Ù‚Ø±Ø¢Ù†ØŸ", options: ["Ø³ÙˆØ±Ø© Ø§Ù„Ø¹Ù„Ù‚", "Ø³ÙˆØ±Ø© Ø§Ù„ÙØ§ØªØ­Ø©", "Ø³ÙˆØ±Ø© Ø§Ù„Ø¨Ù‚Ø±Ø©", "Ø³ÙˆØ±Ø© Ø§Ù„Ù…Ø¯Ø«Ø±"], correct: 0},
            {category: "Ø¯ÙŠÙ†ÙŠØ©", question: "ÙƒÙ… Ø¹Ø¯Ø¯ Ø£Ø±ÙƒØ§Ù† Ø§Ù„Ø¥ÙŠÙ…Ø§Ù†ØŸ", options: ["6 Ø£Ø±ÙƒØ§Ù†", "5 Ø£Ø±ÙƒØ§Ù†", "7 Ø£Ø±ÙƒØ§Ù†", "4 Ø£Ø±ÙƒØ§Ù†"], correct: 0},
            
            // Ø£Ø³Ø¦Ù„Ø© Ø«Ù‚Ø§ÙÙŠØ©
            {category: "Ø«Ù‚Ø§ÙÙŠØ©", question: "Ù…Ù† Ù‡Ùˆ Ù…Ø¤Ù„Ù Ø±ÙˆØ§ÙŠØ© 'Ù…Ø¦Ø© Ø¹Ø§Ù… Ù…Ù† Ø§Ù„Ø¹Ø²Ù„Ø©'ØŸ", options: ["ØºØ§Ø¨Ø±ÙŠÙŠÙ„ ØºØ§Ø±Ø³ÙŠØ§ Ù…Ø§Ø±ÙƒÙŠØ²", "Ø¨Ø§Ø¨Ù„Ùˆ Ù†ÙŠØ±ÙˆØ¯Ø§", "Ø®ÙˆØ±Ø®ÙŠ Ù„ÙˆÙŠØ³ Ø¨ÙˆØ±Ø®ÙŠØ³", "Ø¥ÙŠØ²Ø§Ø¨ÙŠÙ„ Ø§Ù„Ù„ÙŠÙ†Ø¯ÙŠ"], correct: 0},
            {category: "Ø«Ù‚Ø§ÙÙŠØ©", question: "Ù…Ù† Ù‡Ùˆ Ø§Ù„Ø´Ø§Ø¹Ø± Ø§Ù„Ù…Ù„Ù‚Ø¨ Ø¨Ø£Ù…ÙŠØ± Ø§Ù„Ø´Ø¹Ø±Ø§Ø¡ØŸ", options: ["Ø£Ø­Ù…Ø¯ Ø´ÙˆÙ‚ÙŠ", "Ø­Ø§ÙØ¸ Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…", "Ù…Ø­Ù…ÙˆØ¯ Ø¯Ø±ÙˆÙŠØ´", "Ù†Ø²Ø§Ø± Ù‚Ø¨Ø§Ù†ÙŠ"], correct: 0},
            {category: "Ø«Ù‚Ø§ÙÙŠØ©", question: "Ù…Ù† Ù‡Ùˆ Ù…Ø®ØªØ±Ø¹ Ø§Ù„Ù…ØµØ¨Ø§Ø­ Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØŸ", options: ["ØªÙˆÙ…Ø§Ø³ Ø¥Ø¯ÙŠØ³ÙˆÙ†", "Ù†ÙŠÙƒÙˆÙ„Ø§ ØªØ³Ù„Ø§", "Ø£Ù„ÙƒØ³Ù†Ø¯Ø± Ø¨ÙŠÙ„", "Ø¨Ù†Ø¬Ø§Ù…ÙŠÙ† ÙØ±Ø§Ù†ÙƒÙ„ÙŠÙ†"], correct: 0},
            {category: "Ø«Ù‚Ø§ÙÙŠØ©", question: "ÙÙŠ Ø£ÙŠ Ø¹Ø§Ù… Ø³Ù‚Ø·Øª Ø§Ù„Ø¯ÙˆÙ„Ø© Ø§Ù„Ø¹Ø«Ù…Ø§Ù†ÙŠØ©ØŸ", options: ["1924", "1918", "1920", "1930"], correct: 0},
            {category: "Ø«Ù‚Ø§ÙÙŠØ©", question: "Ù…Ù† Ù‡Ùˆ Ù…Ø¤Ø³Ø³ Ø¹Ù„Ù… Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ Ø§Ù„Ø­Ø¯ÙŠØ«ØŸ", options: ["Ø§Ø¨Ù† Ø®Ù„Ø¯ÙˆÙ†", "Ø£Ø±Ø³Ø·Ùˆ", "Ø£ÙÙ„Ø§Ø·ÙˆÙ†", "Ø³Ù‚Ø±Ø§Ø·"], correct: 0},
            
            // Ø£Ø³Ø¦Ù„Ø© Ø¬ØºØ±Ø§ÙÙŠØ©
            {category: "Ø¬ØºØ±Ø§ÙÙŠØ©", question: "Ù…Ø§ Ù‡ÙŠ Ø¹Ø§ØµÙ…Ø© Ø§Ù„ÙŠØ§Ø¨Ø§Ù†ØŸ", options: ["Ø·ÙˆÙƒÙŠÙˆ", "ÙƒÙŠÙˆØªÙˆ", "Ø£ÙˆØ³Ø§ÙƒØ§", "ÙŠÙˆÙƒÙˆÙ‡Ø§Ù…Ø§"], correct: 0},
            {category: "Ø¬ØºØ±Ø§ÙÙŠØ©", question: "Ù…Ø§ Ù‡ÙŠ Ø£ÙƒØ¨Ø± Ù‚Ø§Ø±Ø© ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ", options: ["Ø¢Ø³ÙŠØ§", "Ø£ÙØ±ÙŠÙ‚ÙŠØ§", "Ø£Ù…Ø±ÙŠÙƒØ§ Ø§Ù„Ø´Ù…Ø§Ù„ÙŠØ©", "Ø£ÙˆØ±ÙˆØ¨Ø§"], correct: 0},
            {category: "Ø¬ØºØ±Ø§ÙÙŠØ©", question: "Ù…Ø§ Ù‡Ùˆ Ø£Ø·ÙˆÙ„ Ù†Ù‡Ø± ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ", options: ["Ù†Ù‡Ø± Ø§Ù„Ù†ÙŠÙ„", "Ù†Ù‡Ø± Ø§Ù„Ø£Ù…Ø§Ø²ÙˆÙ†", "Ù†Ù‡Ø± Ø§Ù„ÙŠØ§Ù†ØºØªØ³ÙŠ", "Ù†Ù‡Ø± Ø§Ù„Ù…Ø³ÙŠØ³ÙŠØ¨ÙŠ"], correct: 0},
            {category: "Ø¬ØºØ±Ø§ÙÙŠØ©", question: "ÙƒÙ… Ø¹Ø¯Ø¯ Ø¯ÙˆÙ„ Ø§Ù„Ø¹Ø§Ù„Ù… ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹ØŸ", options: ["195 Ø¯ÙˆÙ„Ø©", "180 Ø¯ÙˆÙ„Ø©", "210 Ø¯ÙˆÙ„Ø©", "150 Ø¯ÙˆÙ„Ø©"], correct: 0},
            {category: "Ø¬ØºØ±Ø§ÙÙŠØ©", question: "Ù…Ø§ Ù‡ÙŠ Ø£ØµØºØ± Ø¯ÙˆÙ„Ø© ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ", options: ["Ø§Ù„ÙØ§ØªÙŠÙƒØ§Ù†", "Ù…ÙˆÙ†Ø§ÙƒÙˆ", "Ø³Ø§Ù† Ù…Ø§Ø±ÙŠÙ†Ùˆ", "Ù„ÙŠØ®ØªÙ†Ø´ØªØ§ÙŠÙ†"], correct: 0},
            {category: "Ø¬ØºØ±Ø§ÙÙŠØ©", question: "ÙÙŠ Ø£ÙŠ Ù‚Ø§Ø±Ø© ØªÙ‚Ø¹ ØµØ­Ø±Ø§Ø¡ Ø§Ù„ØµØ­Ø±Ø§Ø¡ Ø§Ù„ÙƒØ¨Ø±Ù‰ØŸ", options: ["Ø£ÙØ±ÙŠÙ‚ÙŠØ§", "Ø¢Ø³ÙŠØ§", "Ø£Ù…Ø±ÙŠÙƒØ§ Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠØ©", "Ø£Ø³ØªØ±Ø§Ù„ÙŠØ§"], correct: 0},
            
            // Ø£Ø³Ø¦Ù„Ø© Ø±ÙŠØ§Ø¶ÙŠØ©
            {category: "Ø±ÙŠØ§Ø¶ÙŠØ©", question: "ÙƒÙ… Ø¹Ø¯Ø¯ Ù„Ø§Ø¹Ø¨ÙŠ ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù… ÙÙŠ Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„ÙˆØ§Ø­Ø¯ØŸ", options: ["11 Ù„Ø§Ø¹Ø¨Ø§Ù‹", "10 Ù„Ø§Ø¹Ø¨ÙŠÙ†", "12 Ù„Ø§Ø¹Ø¨Ø§Ù‹", "9 Ù„Ø§Ø¹Ø¨ÙŠÙ†"], correct: 0},
            {category: "Ø±ÙŠØ§Ø¶ÙŠØ©", question: "Ù…Ù† Ù‡Ùˆ Ø§Ù„Ù…Ù„Ù‚Ø¨ Ø¨Ù€'Ø§Ù„Ø¯ÙˆÙ†'ØŸ", options: ["Ø¯ÙŠÙŠØºÙˆ Ù…Ø§Ø±Ø§Ø¯ÙˆÙ†Ø§", "Ø¨ÙŠÙ„ÙŠÙ‡", "ÙƒØ±ÙŠØ³ØªÙŠØ§Ù†Ùˆ Ø±ÙˆÙ†Ø§Ù„Ø¯Ùˆ", "Ù„ÙŠÙˆÙ†ÙŠÙ„ Ù…ÙŠØ³ÙŠ"], correct: 0},
            {category: "Ø±ÙŠØ§Ø¶ÙŠØ©", question: "ÙƒÙ… Ø¹Ø¯Ø¯ Ø­Ù„Ù‚Ø§Øª Ø´Ø¹Ø§Ø± Ø§Ù„Ø£ÙˆÙ„Ù…Ø¨ÙŠØ§Ø¯ØŸ", options: ["5 Ø­Ù„Ù‚Ø§Øª", "4 Ø­Ù„Ù‚Ø§Øª", "6 Ø­Ù„Ù‚Ø§Øª", "7 Ø­Ù„Ù‚Ø§Øª"], correct: 0},
            {category: "Ø±ÙŠØ§Ø¶ÙŠØ©", question: "ÙÙŠ Ø£ÙŠ Ø¨Ù„Ø¯ Ù†Ø´Ø£Øª Ø±ÙŠØ§Ø¶Ø© Ø§Ù„ÙƒØ§Ø±Ø§ØªÙŠÙ‡ØŸ", options: ["Ø§Ù„ÙŠØ§Ø¨Ø§Ù†", "Ø§Ù„ØµÙŠÙ†", "ÙƒÙˆØ±ÙŠØ§", "ØªØ§ÙŠÙ„Ø§Ù†Ø¯"], correct: 0},
            {category: "Ø±ÙŠØ§Ø¶ÙŠØ©", question: "ÙƒÙ… ÙŠØ³ØªØºØ±Ù‚ Ø´ÙˆØ· ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù…ØŸ", options: ["45 Ø¯Ù‚ÙŠÙ‚Ø©", "40 Ø¯Ù‚ÙŠÙ‚Ø©", "50 Ø¯Ù‚ÙŠÙ‚Ø©", "60 Ø¯Ù‚ÙŠÙ‚Ø©"], correct: 0},
            
            // Ø£Ø³Ø¦Ù„Ø© Ø£ÙÙ„Ø§Ù… ÙˆÙ…Ø³Ù„Ø³Ù„Ø§Øª
            {category: "Ø£ÙÙ„Ø§Ù…", question: "Ù…Ù† Ù‡Ùˆ Ø¨Ø·Ù„ ÙÙŠÙ„Ù… 'ØªØ§ÙŠØªØ§Ù†ÙŠÙƒ'ØŸ", options: ["Ù„ÙŠÙˆÙ†Ø§Ø±Ø¯Ùˆ Ø¯ÙŠ ÙƒØ§Ø¨Ø±ÙŠÙˆ", "Ø¨Ø±Ø§Ø¯ Ø¨ÙŠØª", "ØªÙˆÙ… ÙƒØ±ÙˆØ²", "Ø¬ÙˆÙ†ÙŠ Ø¯ÙŠØ¨"], correct: 0},
            {category: "Ø£ÙÙ„Ø§Ù…", question: "Ù…Ø§ Ù‡Ùˆ Ø£Ø¹Ù„Ù‰ ÙÙŠÙ„Ù… Ø¥ÙŠØ±Ø§Ø¯Ø§Ù‹ ÙÙŠ Ø§Ù„ØªØ§Ø±ÙŠØ®ØŸ", options: ["Ø£ÙØ§ØªØ§Ø±", "Ø£ÙÙ†Ø¬Ø±Ø² Ø¥Ù†Ø¯ ØºÙŠÙ…", "ØªØ§ÙŠØªØ§Ù†ÙŠÙƒ", "Ø­Ø±Ø¨ Ø§Ù„Ù†Ø¬ÙˆÙ…"], correct: 0},
            {category: "Ø£ÙÙ„Ø§Ù…", question: "Ù…Ù† Ø£Ø®Ø±Ø¬ ÙÙŠÙ„Ù… 'Ø§Ù„Ø¹Ø±Ø§Ø¨'ØŸ", options: ["ÙØ±Ø§Ù†Ø³ÙŠØ³ ÙÙˆØ±Ø¯ ÙƒÙˆØ¨ÙˆÙ„Ø§", "Ù…Ø§Ø±ØªÙ† Ø³ÙƒÙˆØ±Ø³ÙŠØ²ÙŠ", "Ø³ØªÙŠÙÙ† Ø³Ø¨ÙŠÙ„Ø¨Ø±Øº", "ÙƒÙˆÙŠÙ†ØªÙ† ØªØ§Ø±Ø§Ù†ØªÙŠÙ†Ùˆ"], correct: 0},
            {category: "Ù…Ø³Ù„Ø³Ù„Ø§Øª", question: "ÙƒÙ… Ù…ÙˆØ³Ù…Ø§Ù‹ Ø§Ø³ØªÙ…Ø± Ù…Ø³Ù„Ø³Ù„ 'ÙØ±ÙŠÙ†Ø¯Ø²'ØŸ", options: ["10 Ù…ÙˆØ§Ø³Ù…", "8 Ù…ÙˆØ§Ø³Ù…", "12 Ù…ÙˆØ³Ù…Ø§Ù‹", "9 Ù…ÙˆØ§Ø³Ù…"], correct: 0},
            {category: "Ù…Ø³Ù„Ø³Ù„Ø§Øª", question: "Ù…Ø§ Ù‡Ùˆ Ø§Ø³Ù… Ø§Ù„ØªÙ†ÙŠÙ† ÙÙŠ Ù…Ø³Ù„Ø³Ù„ 'ØµØ±Ø§Ø¹ Ø§Ù„Ø¹Ø±ÙˆØ´'ØŸ", options: ["Ø¯Ø±ÙˆØºÙˆÙ†", "ÙØ§Ù„Ø§Ø±", "Ø±Ø§ÙŠÙ†ÙŠØ±Ø§", "ÙÙŠØ³ÙŠØ±ÙŠÙˆÙ†"], correct: 0},
            
            // Ø£Ø³Ø¦Ù„Ø© Ø¹Ù„Ù…ÙŠØ©
            {category: "Ø¹Ù„Ù…ÙŠØ©", question: "ÙƒÙ… Ø¹Ø¯Ø¯ ÙƒÙˆØ§ÙƒØ¨ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø´Ù…Ø³ÙŠØ©ØŸ", options: ["8 ÙƒÙˆØ§ÙƒØ¨", "9 ÙƒÙˆØ§ÙƒØ¨", "7 ÙƒÙˆØ§ÙƒØ¨", "10 ÙƒÙˆØ§ÙƒØ¨"], correct: 0},
            {category: "Ø¹Ù„Ù…ÙŠØ©", question: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø±Ù…Ø² Ø§Ù„ÙƒÙŠÙ…ÙŠØ§Ø¦ÙŠ Ù„Ù„Ø°Ù‡Ø¨ØŸ", options: ["Au", "Ag", "Fe", "Cu"], correct: 0},
            {category: "Ø¹Ù„Ù…ÙŠØ©", question: "Ù…Ø§ Ù‡ÙŠ Ø³Ø±Ø¹Ø© Ø§Ù„Ø¶ÙˆØ¡ØŸ", options: ["300,000 ÙƒÙ…/Ø«", "200,000 ÙƒÙ…/Ø«", "400,000 ÙƒÙ…/Ø«", "250,000 ÙƒÙ…/Ø«"], correct: 0},
            {category: "Ø¹Ù„Ù…ÙŠØ©", question: "Ù…Ù† Ù‡Ùˆ Ù…ÙƒØªØ´Ù Ù†Ø¸Ø±ÙŠØ© Ø§Ù„Ù†Ø³Ø¨ÙŠØ©ØŸ", options: ["Ø£Ù„Ø¨Ø±Øª Ø£ÙŠÙ†Ø´ØªØ§ÙŠÙ†", "Ø¥Ø³Ø­Ø§Ù‚ Ù†ÙŠÙˆØªÙ†", "ØºØ§Ù„ÙŠÙ„ÙŠÙˆ ØºØ§Ù„ÙŠÙ„ÙŠ", "Ø³ØªÙŠÙÙ† Ù‡ÙˆÙƒÙŠÙ†Øº"], correct: 0},
            
            // Ø£Ø³Ø¦Ù„Ø© Ø¹Ø§Ù…Ø©
            {category: "Ø¹Ø§Ù…Ø©", question: "ÙƒÙ… Ø¹Ø¯Ø¯ Ø£Ù„ÙˆØ§Ù† Ù‚ÙˆØ³ Ù‚Ø²Ø­ØŸ", options: ["7 Ø£Ù„ÙˆØ§Ù†", "6 Ø£Ù„ÙˆØ§Ù†", "8 Ø£Ù„ÙˆØ§Ù†", "5 Ø£Ù„ÙˆØ§Ù†"], correct: 0},
            {category: "Ø¹Ø§Ù…Ø©", question: "ÙƒÙ… Ø¹Ø¯Ø¯ Ø£ÙŠØ§Ù… Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ÙŠØ©ØŸ", options: ["365 ÙŠÙˆÙ…", "360 ÙŠÙˆÙ…", "366 ÙŠÙˆÙ…", "364 ÙŠÙˆÙ…"], correct: 0},
            {category: "Ø¹Ø§Ù…Ø©", question: "Ù…Ø§ Ù‡Ùˆ Ø£ÙƒØ¨Ø± Ø­ÙŠÙˆØ§Ù† ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ", options: ["Ø§Ù„Ø­ÙˆØª Ø§Ù„Ø£Ø²Ø±Ù‚", "Ø§Ù„ÙÙŠÙ„ Ø§Ù„Ø£ÙØ±ÙŠÙ‚ÙŠ", "Ø§Ù„Ø²Ø±Ø§ÙØ©", "Ø§Ù„Ø¯Ø¨ Ø§Ù„Ù‚Ø·Ø¨ÙŠ"], correct: 0},
            {category: "Ø¹Ø§Ù…Ø©", question: "ÙƒÙ… Ø¹Ø¯Ø¯ Ù‚Ù„ÙˆØ¨ Ø§Ù„Ø£Ø®Ø·Ø¨ÙˆØ·ØŸ", options: ["3 Ù‚Ù„ÙˆØ¨", "2 Ù‚Ù„Ø¨Ø§Ù†", "4 Ù‚Ù„ÙˆØ¨", "1 Ù‚Ù„Ø¨"], correct: 0},
            {category: "Ø¹Ø§Ù…Ø©", question: "Ù…Ø§ Ù‡ÙŠ Ø£ÙƒØ¨Ø± Ø¯ÙˆÙ„Ø© ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù… Ù…Ù† Ø­ÙŠØ« Ø§Ù„Ù…Ø³Ø§Ø­Ø©ØŸ", options: ["Ø±ÙˆØ³ÙŠØ§", "ÙƒÙ†Ø¯Ø§", "Ø§Ù„ØµÙŠÙ†", "Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª Ø§Ù„Ù…ØªØ­Ø¯Ø©"], correct: 0},
            {category: "Ø¹Ø§Ù…Ø©", question: "ÙƒÙ… Ø¹Ø¯Ø¯ Ø£Ø³Ù†Ø§Ù† Ø§Ù„Ø¥Ù†Ø³Ø§Ù† Ø§Ù„Ø¨Ø§Ù„ØºØŸ", options: ["32 Ø³Ù†", "28 Ø³Ù†", "30 Ø³Ù†", "34 Ø³Ù†"], correct: 0},
            {category: "Ø¹Ø§Ù…Ø©", question: "Ù…Ø§ Ù‡ÙŠ Ø¹Ù…Ù„Ø© Ø§Ù„ÙŠØ§Ø¨Ø§Ù†ØŸ", options: ["Ø§Ù„ÙŠÙ†", "Ø§Ù„ÙŠÙˆØ§Ù†", "Ø§Ù„ÙˆÙˆÙ†", "Ø§Ù„Ø±ÙˆØ¨ÙŠØ©"], correct: 0}
        ];

        // Game State
        let gameState = {
            team1: { name: "", players: [], winners: [], score: 0 },
            team2: { name: "", players: [], winners: [], score: 0 },
            currentQuestion: null,
            questionStartTime: 0,
            currentPlayer: null,
            currentTeam: null,
            timer: 0,
            gamePhase: 'waiting', // waiting, question, options, answered
            usedQuestions: []
        };

        let timerInterval = null;
        let gameId = null;

        // Make functions global
        window.startGame = startGame;
        window.playerBuzzIn = playerBuzzIn;
        window.selectOption = selectOption;
        window.joinWinner = joinWinner;
        window.stealWinner = stealWinner;

        // Setup player inputs
        document.getElementById('team1Count').addEventListener('change', function() {
            updatePlayerInputs('team1', this.value);
        });
        document.getElementById('team2Count').addEventListener('change', function() {
            updatePlayerInputs('team2', this.value);
        });

        function updatePlayerInputs(team, count) {
            const container = document.getElementById(team + 'Players');
            container.innerHTML = '';
            for (let i = 1; i <= count; i++) {
                const div = document.createElement('div');
                div.className = 'player-input';
                div.innerHTML = `<input type="text" placeholder="Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ ${i}" id="${team}Player${i}">`;
                container.appendChild(div);
            }
        }

        // Initialize
        updatePlayerInputs('team1', 2);
        updatePlayerInputs('team2', 2);

        function startGame() {
            const team1Name = document.getElementById('team1Name').value || 'Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£ÙˆÙ„';
            const team2Name = document.getElementById('team2Name').value || 'Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø«Ø§Ù†ÙŠ';
            const team1Count = document.getElementById('team1Count').value;
            const team2Count = document.getElementById('team2Count').value;

            gameState.team1.name = team1Name;
            gameState.team2.name = team2Name;
            gameState.team1.players = [];
            gameState.team2.players = [];

            for (let i = 1; i <= team1Count; i++) {
                const playerName = document.getElementById(`team1Player${i}`).value || `Ù„Ø§Ø¹Ø¨ ${i}`;
                gameState.team1.players.push({ name: playerName, id: `team1-${i}` });
            }

            for (let i = 1; i <= team2Count; i++) {
                const playerName = document.getElementById(`team2Player${i}`).value || `Ù„Ø§Ø¹Ø¨ ${i}`;
                gameState.team2.players.push({ name: playerName, id: `team2-${i}` });
            }

            // Create game in Firebase
            gameId = 'game-' + Date.now();
            const gameRef = ref(database, 'games/' + gameId);
            set(gameRef, gameState);

            // Listen to game updates
            onValue(gameRef, (snapshot) => {
                if (snapshot.exists()) {
                    gameState = snapshot.val();
                    updateGameUI();
                }
            });

            document.querySelector('.setup-screen').classList.remove('active');
            document.querySelector('.game-screen').classList.add('active');

            setupGameBoard();
            startNewQuestion();
        }

        function setupGameBoard() {
            document.getElementById('displayTeam1Name').textContent = gameState.team1.name;
            document.getElementById('displayTeam2Name').textContent = gameState.team2.name;
            document.getElementById('team1PanelName').textContent = gameState.team1.name;
            document.getElementById('team2PanelName').textContent = gameState.team2.name;

            const team1Buttons = document.getElementById('team1Buttons');
            const team2Buttons = document.getElementById('team2Buttons');

            team1Buttons.innerHTML = '';
            team2Buttons.innerHTML = '';

            gameState.team1.players.forEach((player, index) => {
                const btn = document.createElement('button');
                btn.className = 'player-btn';
                btn.textContent = player.name;
                btn.onclick = () => playerBuzzIn('team1', index);
                btn.id = `btn-${player.id}`;
                team1Buttons.appendChild(btn);
            });

            gameState.team2.players.forEach((player, index) => {
                const btn = document.createElement('button');
                btn.className = 'player-btn';
                btn.textContent = player.name;
                btn.onclick = () => playerBuzzIn('team2', index);
                btn.id = `btn-${player.id}`;
                team2Buttons.appendChild(btn);
            });
        }

        function startNewQuestion() {
            if (gameState.usedQuestions.length >= questions.length) {
                gameState.usedQuestions = [];
            }

            let randomQuestion;
            do {
                randomQuestion = questions[Math.floor(Math.random() * questions.length)];
            } while (gameState.usedQuestions.includes(randomQuestion.question));

            gameState.currentQuestion = randomQuestion;
            gameState.usedQuestions.push(randomQuestion.question);
            gameState.gamePhase = 'question';
            gameState.questionStartTime = Date.now();
            gameState.currentPlayer = null;
            gameState.currentTeam = null;

            updateGameState();

            document.getElementById('questionText').textContent = randomQuestion.question;
            document.getElementById('optionsContainer').innerHTML = '';
            document.getElementById('actionButtons').innerHTML = '';
            document.getElementById('statusMessage').textContent = 'Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø©!';
            document.getElementById('statusMessage').className = 'status-message info';

            // Enable all non-winner buttons
            enableAllButtons();

            // Show options after 5 seconds
            setTimeout(() => {
                if (gameState.gamePhase === 'question') {
                    showOptions();
                }
            }, 5000);
        }

        function showOptions() {
            gameState.gamePhase = 'options';
            updateGameState();

            const container = document.getElementById('optionsContainer');
            container.innerHTML = '';

            gameState.currentQuestion.options.forEach((option, index) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.textContent = option;
                btn.onclick = () => selectOption(index);
                btn.id = `option-${index}`;
                container.appendChild(btn);
            });

            if (!gameState.currentPlayer) {
                startTimer(20);
            }
        }

        function playerBuzzIn(team, playerIndex) {
            if (gameState.gamePhase !== 'question' && gameState.gamePhase !== 'options') return;
            if (gameState.currentPlayer) return;

            const player = gameState[team].players[playerIndex];
            if (gameState[team].winners.includes(player.id)) return;

            gameState.currentPlayer = playerIndex;
            gameState.currentTeam = team;

            updateGameState();

            document.getElementById('statusMessage').textContent = `${player.name} Ù…Ù† ${gameState[team].name} ÙŠØ¬ÙŠØ¨...`;
            document.getElementById('statusMessage').className = 'status-message info';

            if (gameState.gamePhase === 'question') {
                showOptions();
            }

            disableOtherButtons(team, playerIndex);
            startTimer(20);
        }

        function selectOption(optionIndex) {
            if (!gameState.currentPlayer && gameState.gamePhase === 'options') return;

            clearInterval(timerInterval);
            const correct = optionIndex === gameState.currentQuestion.correct;

            // Highlight correct/incorrect
            document.querySelectorAll('.option-btn').forEach((btn, index) => {
                if (index === gameState.currentQuestion.correct) {
                    btn.classList.add('correct');
                } else if (index === optionIndex && !correct) {
                    btn.classList.add('incorrect');
                }
                btn.disabled = true;
            });

            if (correct && gameState.currentPlayer !== null) {
                handleCorrectAnswer();
            } else if (!correct && gameState.currentPlayer !== null) {
                handleIncorrectAnswer();
            } else {
                setTimeout(() => {
                    startNewQuestion();
                }, 3000);
            }
        }

        function handleCorrectAnswer() {
            const team = gameState.currentTeam;
            const player = gameState[team].players[gameState.currentPlayer];

            // Check if other team has winners
            const otherTeam = team === 'team1' ? 'team2' : 'team1';
            const hasOtherWinners = gameState[otherTeam].winners.length > 0;

            if (hasOtherWinners) {
                // Show action buttons
                document.getElementById('statusMessage').textContent = `Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! ${player.name} ÙŠÙ…ÙƒÙ†Ù‡ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±:`;
                document.getElementById('statusMessage').className = 'status-message success';

                const actionButtons = document.getElementById('actionButtons');
                actionButtons.innerHTML = `
                    <button class="action-btn join" onclick="joinWinner()">Ø§Ù„Ø¬Ù„ÙˆØ³ ÙÙŠ Ù…Ù‚Ø¹Ø¯ Ø§Ù„ÙÙˆØ² ğŸ†</button>
                    <button class="action-btn steal" onclick="stealWinner()">Ø³Ø­Ø¨ Ù„Ø§Ø¹Ø¨ Ù…Ù† Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø¢Ø®Ø± ğŸ¯</button>
                `;
            } else {
                // Directly add to winners
                gameState[team].winners.push(player.id);
                gameState[team].score++;
                updateGameState();

                document.getElementById('statusMessage').textContent = `Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! ${player.name} ÙÙŠ Ù…Ù‚Ø¹Ø¯ Ø§Ù„ÙÙˆØ²! ğŸ‰`;
                document.getElementById('statusMessage').className = 'status-message success';

                checkVictory();
                
                setTimeout(() => {
                    startNewQuestion();
                }, 3000);
            }
        }

        function joinWinner() {
            const team = gameState.currentTeam;
            const player = gameState[team].players[gameState.currentPlayer];
            
            gameState[team].winners.push(player.id);
            gameState[team].score++;
            
            updateGameState();

            document.getElementById('actionButtons').innerHTML = '';
            checkVictory();

            setTimeout(() => {
                startNewQuestion();
            }, 3000);
        }

        function stealWinner() {
            const team = gameState.currentTeam;
            const otherTeam = team === 'team1' ? 'team2' : 'team1';
            
            if (gameState[otherTeam].winners.length > 0) {
                const stolenPlayer = gameState[otherTeam].winners.pop();
                gameState[otherTeam].score--;
                
                const player = gameState[team].players[gameState.currentPlayer];
                gameState[team].winners.push(player.id);
                gameState[team].score++;
                
                updateGameState();

                document.getElementById('statusMessage').textContent = `ØªÙ… Ø§Ù„Ø³Ø­Ø¨! ${player.name} ÙÙŠ Ù…Ù‚Ø¹Ø¯ Ø§Ù„ÙÙˆØ²!`;
                document.getElementById('actionButtons').innerHTML = '';

                setTimeout(() => {
                    startNewQuestion();
                }, 3000);
            }
        }

        function handleIncorrectAnswer() {
            const team = gameState.currentTeam;
            const player = gameState[team].players[gameState.currentPlayer];
            const otherTeam = team === 'team1' ? 'team2' : 'team1';

            document.getElementById('statusMessage').textContent = `Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©! ÙØ±ØµØ© ${gameState[otherTeam].name}`;
            document.getElementById('statusMessage').className = 'status-message error';

            // Disable current team, enable other team
            disableTeamButtons(team);
            enableTeamButtons(otherTeam);

            gameState.currentPlayer = null;
            gameState.currentTeam = null;
            updateGameState();

            startTimer(20);
        }

        function startTimer(seconds) {
            clearInterval(timerInterval);
            gameState.timer = seconds;

            const timerElement = document.getElementById('timer');
            timerElement.textContent = seconds;
            timerElement.classList.remove('warning');

            timerInterval = setInterval(() => {
                gameState.timer--;
                timerElement.textContent = gameState.timer;

                if (gameState.timer <= 5) {
                    timerElement.classList.add('warning');
                }

                if (gameState.timer <= 0) {
                    clearInterval(timerInterval);
                    document.getElementById('statusMessage').textContent = 'Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª!';
                    document.getElementById('statusMessage').className = 'status-message error';
                    
                    setTimeout(() => {
                        startNewQuestion();
                    }, 2000);
                }
            }, 1000);
        }

        function enableAllButtons() {
            gameState.team1.players.forEach(player => {
                const btn = document.getElementById(`btn-${player.id}`);
                if (!gameState.team1.winners.includes(player.id)) {
                    btn.disabled = false;
                    btn.classList.remove('winner');
                } else {
                    btn.disabled = true;
                    btn.classList.add('winner');
                }
            });

            gameState.team2.players.forEach(player => {
                const btn = document.getElementById(`btn-${player.id}`);
                if (!gameState.team2.winners.includes(player.id)) {
                    btn.disabled = false;
                    btn.classList.remove('winner');
                } else {
                    btn.disabled = true;
                    btn.classList.add('winner');
                }
            });
        }

        function disableOtherButtons(team, playerIndex) {
            const otherTeam = team === 'team1' ? 'team2' : 'team1';
            
            gameState[team].players.forEach((player, index) => {
                if (index !== playerIndex) {
                    document.getElementById(`btn-${player.id}`).disabled = true;
                }
            });

            gameState[otherTeam].players.forEach(player => {
                document.getElementById(`btn-${player.id}`).disabled = true;
            });
        }

        function disableTeamButtons(team) {
            gameState[team].players.forEach(player => {
                document.getElementById(`btn-${player.id}`).disabled = true;
            });
        }

        function enableTeamButtons(team) {
            gameState[team].players.forEach(player => {
                if (!gameState[team].winners.includes(player.id)) {
                    document.getElementById(`btn-${player.id}`).disabled = false;
                }
            });
        }

        function checkVictory() {
            const team1Full = gameState.team1.winners.length === gameState.team1.players.length;
            const team2Full = gameState.team2.winners.length === gameState.team2.players.length;

            if (team1Full || team2Full) {
                clearInterval(timerInterval);
                const winner = team1Full ? gameState.team1.name : gameState.team2.name;
                
                document.querySelector('.game-screen').classList.remove('active');
                document.querySelector('.victory-screen').classList.add('active');
                document.getElementById('victoryMessage').textContent = `ğŸ‰ ${winner} ÙØ§Ø² Ø¨Ø§Ù„Ù„Ø¹Ø¨Ø©! ğŸ‰`;
            }
        }

        function updateGameUI() {
            document.getElementById('team1Score').textContent = gameState.team1.score;
            document.getElementById('team2Score').textContent = gameState.team2.score;

            // Update winner lists
            const team1Winners = document.getElementById('team1Winners');
            const team2Winners = document.getElementById('team2Winners');

            team1Winners.innerHTML = '';
            gameState.team1.winners.forEach(playerId => {
                const player = gameState.team1.players.find(p => p.id === playerId);
                const badge = document.createElement('div');
                badge.className = 'winner-badge';
                badge.textContent = player.name;
                team1Winners.appendChild(badge);
            });

            team2Winners.innerHTML = '';
            gameState.team2.winners.forEach(playerId => {
                const player = gameState.team2.players.find(p => p.id === playerId);
                const badge = document.createElement('div');
                badge.className = 'winner-badge';
                badge.textContent = player.name;
                team2Winners.appendChild(badge);
            });
        }

        function updateGameState() {
            if (gameId) {
                const gameRef = ref(database, 'games/' + gameId);
                update(gameRef, gameState);
            }
        }
    </script>
</body>
</html>
