<!DOCTYPE html>

<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„Ø¹Ø¨Ø© Ø§Ù„ÙƒÙ†Ø¨Ø© - Ø£Ø³Ø¦Ù„Ø© ÙˆØ£Ø¬ÙˆØ¨Ø©</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a0b2e 0%, #3d2463 50%, #1a0b2e 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        /* Ramadan decorations */
        body::before {
            content: 'ğŸŒ™âœ¨ğŸ•Œâœ¨â­âœ¨ğŸŒ™âœ¨ğŸ•Œâœ¨â­';
            position: fixed;
            top: 10px;
            left: 0;
            right: 0;
            text-align: center;
            font-size: 1.5em;
            z-index: 0;
            opacity: 0.6;
            animation: twinkle 3s ease-in-out infinite;
        }

        body::after {
            content: 'â­âœ¨ğŸŒ™âœ¨ğŸ•Œâœ¨â­âœ¨ğŸŒ™âœ¨ğŸ•Œ';
            position: fixed;
            bottom: 10px;
            left: 0;
            right: 0;
            text-align: center;
            font-size: 1.5em;
            z-index: 0;
            opacity: 0.6;
            animation: twinkle 3s ease-in-out infinite 1.5s;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.4; }
            50% { opacity: 0.8; }
        }

        .container {
            background: linear-gradient(135deg, #2d1b4e 0%, #4a2c6f 100%);
            border-radius: 25px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5), 0 0 30px rgba(212, 175, 55, 0.3);
            max-width: 500px;
            width: 100%;
            padding: 40px;
            position: relative;
            z-index: 1;
            border: 3px solid #d4af37;
        }

        .host-container {
            max-width: 1400px;
            background: linear-gradient(135deg, #2d1b4e 0%, #4a2c6f 100%);
        }

        h1 {
            text-align: center;
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 50%, #ffd700 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
            animation: glow 2s ease-in-out infinite;
        }

        @keyframes glow {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.3); }
        }

        .screen {
            display: none;
        }

        .screen.active {
            display: block;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #ffd700;
        }

        .input-group input, .input-group select {
            width: 100%;
            padding: 15px;
            border: 2px solid #d4af37;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
            background: rgba(255, 255, 255, 0.95);
        }

        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #ffd700;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }

        .btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #d4af37 0%, #aa8929 100%);
            color: #1a0b2e;
            border: none;
            border-radius: 10px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
            box-shadow: 0 5px 15px rgba(212, 175, 55, 0.4);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(212, 175, 55, 0.6);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn.secondary {
            background: linear-gradient(135deg, #6a4c93 0%, #533a71 100%);
            color: #ffd700;
        }

        .btn.success {
            background: linear-gradient(135deg, #00a86b 0%, #008c59 100%);
            color: white;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .room-code {
            text-align: center;
            padding: 25px;
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.2) 0%, rgba(170, 137, 41, 0.2) 100%);
            border-radius: 20px;
            margin: 20px 0;
            border: 2px solid #d4af37;
        }

        .room-code h2 {
            color: #ffd700;
            font-size: 1.3em;
            margin-bottom: 10px;
        }

        .code {
            font-size: 3em;
            font-weight: bold;
            color: #ffd700;
            letter-spacing: 10px;
            font-family: monospace;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
        }

        .players-list {
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.15) 0%, rgba(170, 137, 41, 0.15) 100%);
            border-radius: 20px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid rgba(212, 175, 55, 0.5);
        }

        .players-list h3 {
            color: #ffd700;
            margin-bottom: 15px;
        }

        .player-item {
            background: rgba(255, 255, 255, 0.95);
            padding: 12px 15px;
            margin-bottom: 10px;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            border: 1px solid #d4af37;
        }

        .player-name {
            font-weight: bold;
            color: #2d1b4e;
        }

        .team-badge {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
            color: white;
        }

        .team-badge.team1 {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }

        .team-badge.team2 {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        }

        .game-board {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 30px 0;
        }

        .team-section {
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.15) 0%, rgba(170, 137, 41, 0.15) 100%);
            border-radius: 20px;
            padding: 25px;
            border: 2px solid rgba(212, 175, 55, 0.5);
        }

        .team-header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(212, 175, 55, 0.3);
        }

        .team-name {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .team1 .team-name {
            color: #e74c3c;
        }

        .team2 .team-name {
            color: #3498db;
        }

        .couch-container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            min-height: 150px;
            margin-bottom: 20px;
            border: 2px dashed rgba(212, 175, 55, 0.3);
        }

        .couch-title {
            color: #ffd700;
            font-size: 1.1em;
            margin-bottom: 15px;
            text-align: center;
            font-weight: bold;
        }

        .couch-players {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .couch-player {
            background: rgba(255, 255, 255, 0.9);
            padding: 12px;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
            color: #2d1b4e;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .waiting-players {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .waiting-player {
            background: rgba(255, 255, 255, 0.7);
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            font-weight: 500;
            color: #2d1b4e;
            font-size: 0.95em;
        }

        .question-display {
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.2) 0%, rgba(170, 137, 41, 0.2) 100%);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            border: 2px solid #d4af37;
            text-align: center;
        }

        .question-text {
            font-size: 1.8em;
            color: #ffd700;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .timer {
            font-size: 3em;
            font-weight: bold;
            color: #ffd700;
            margin: 20px 0;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
        }

        .timer.warning {
            color: #e74c3c;
            animation: pulse 0.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .answer-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }

        .answer-btn {
            padding: 20px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.8) 100%);
            border: 2px solid #d4af37;
            border-radius: 15px;
            font-size: 1.1em;
            font-weight: bold;
            color: #2d1b4e;
            cursor: pointer;
            transition: all 0.3s;
        }

        .answer-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(212, 175, 55, 0.6);
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
        }

        .answer-btn.correct {
            background: linear-gradient(135deg, #00a86b 0%, #008c59 100%);
            color: white;
            border-color: #00a86b;
        }

        .answer-btn.incorrect {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            border-color: #e74c3c;
        }

        .buzz-button {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            border: 5px solid #ffd700;
            font-size: 3em;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            margin: 30px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 30px rgba(231, 76, 60, 0.5);
        }

        .buzz-button:hover:not(:disabled) {
            transform: scale(1.1);
            box-shadow: 0 15px 40px rgba(231, 76, 60, 0.7);
        }

        .buzz-button:active:not(:disabled) {
            transform: scale(0.95);
        }

        .buzz-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .status-message {
            text-align: center;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            font-size: 1.3em;
            font-weight: bold;
        }

        .status-message.info {
            background: rgba(52, 152, 219, 0.2);
            color: #3498db;
            border: 2px solid #3498db;
        }

        .status-message.success {
            background: rgba(0, 168, 107, 0.2);
            color: #00a86b;
            border: 2px solid #00a86b;
        }

        .status-message.error {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
            border: 2px solid #e74c3c;
        }

        .status-message.warning {
            background: rgba(241, 196, 15, 0.2);
            color: #f1c40f;
            border: 2px solid #f1c40f;
        }

        .choice-buttons {
            display: flex;
            gap: 15px;
            margin: 20px 0;
        }

        .choice-btn {
            flex: 1;
            padding: 20px;
            border: none;
            border-radius: 15px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .choice-btn.sit {
            background: linear-gradient(135deg, #00a86b 0%, #008c59 100%);
            color: white;
        }

        .choice-btn.steal {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
        }

        .choice-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.4);
        }

        .buzzer-indicator {
            background: linear-gradient(135deg, #f1c40f 0%, #f39c12 100%);
            color: #1a0b2e;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
            font-size: 1.2em;
            margin: 20px 0;
            animation: flash 0.5s ease-in-out infinite;
        }

        @keyframes flash {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        #victoryScreen {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.9);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
        }

        #victoryScreen.active {
            display: flex;
        }

        .victory-content {
            background: linear-gradient(135deg, #2d1b4e 0%, #4a2c6f 100%);
            border-radius: 25px;
            padding: 60px;
            text-align: center;
            border: 5px solid #d4af37;
            box-shadow: 0 0 50px rgba(212, 175, 55, 0.8);
        }

        #victoryMessage {
            font-size: 3em;
            color: #ffd700;
            margin-bottom: 30px;
            text-shadow: 0 0 30px rgba(255, 215, 0, 0.8);
        }

        @media (max-width: 768px) {
            .game-board {
                grid-template-columns: 1fr;
            }

            .answer-options {
                grid-template-columns: 1fr;
            }

            h1 {
                font-size: 1.8em;
            }

            .question-text {
                font-size: 1.3em;
            }

            .buzz-button {
                width: 150px;
                height: 150px;
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container" id="mainContainer">
        <!-- Main Menu Screen -->
        <div id="mainMenu" class="screen active">
            <h1>ğŸ›‹ï¸ Ù„Ø¹Ø¨Ø© Ø§Ù„ÙƒÙ†Ø¨Ø© ğŸ›‹ï¸</h1>
            <button class="btn" onclick="showScreen('createRoomScreen')">Ø¥Ù†Ø´Ø§Ø¡ ØºØ±ÙØ© Ø¬Ø¯ÙŠØ¯Ø©</button>
            <button class="btn secondary" onclick="showScreen('joinRoomScreen')">Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ù„ØºØ±ÙØ©</button>
        </div>

        <!-- Create Room Screen -->
        <div id="createRoomScreen" class="screen">
            <h1>Ø¥Ù†Ø´Ø§Ø¡ ØºØ±ÙØ© Ø¬Ø¯ÙŠØ¯Ø©</h1>
            <div class="input-group">
                <label>Ø§Ø³Ù… Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£ÙˆÙ„:</label>
                <input type="text" id="team1Name" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ø£Ø¨Ø·Ø§Ù„" required>
            </div>
            <div class="input-group">
                <label>Ø§Ø³Ù… Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø«Ø§Ù†ÙŠ:</label>
                <input type="text" id="team2Name" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ù†Ø¬ÙˆÙ…" required>
            </div>
            <div class="input-group">
                <label>Ø¹Ø¯Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† ÙÙŠ ÙƒÙ„ ÙØ±ÙŠÙ‚:</label>
                <select id="teamSize">
                    <option value="2">2 Ù„Ø§Ø¹Ø¨ÙŠÙ†</option>
                    <option value="3">3 Ù„Ø§Ø¹Ø¨ÙŠÙ†</option>
                    <option value="4">4 Ù„Ø§Ø¹Ø¨ÙŠÙ†</option>
                    <option value="5">5 Ù„Ø§Ø¹Ø¨ÙŠÙ†</option>
                </select>
            </div>
            <button class="btn" onclick="createRoom()">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØºØ±ÙØ©</button>
            <button class="btn secondary" onclick="showScreen('mainMenu')">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
        </div>

        <!-- Join Room Screen -->
        <div id="joinRoomScreen" class="screen">
            <h1>Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ù„ØºØ±ÙØ©</h1>
            <div class="input-group">
                <label>Ø§Ø³Ù…Ùƒ:</label>
                <input type="text" id="playerName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ" required>
            </div>
            <div class="input-group">
                <label>Ø±Ù…Ø² Ø§Ù„ØºØ±ÙØ©:</label>
                <input type="text" id="roomCode" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù…Ø² Ø§Ù„ØºØ±ÙØ© Ø§Ù„Ù…ÙƒÙˆÙ† Ù…Ù† 6 Ø£Ø±Ù‚Ø§Ù…" maxlength="6" required>
            </div>
            <button class="btn" onclick="joinRoom()">Ø§Ù†Ø¶Ù… Ù„Ù„ØºØ±ÙØ©</button>
            <button class="btn secondary" onclick="showScreen('mainMenu')">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
        </div>

        <!-- Team Selection Screen -->
        <div id="teamSelectionScreen" class="screen">
            <h1>Ø§Ø®ØªØ± ÙØ±ÙŠÙ‚Ùƒ</h1>
            <div id="teamSelectionMessage" class="status-message info"></div>
            <button class="btn" id="selectTeam1Btn" onclick="selectTeam('team1')"></button>
            <button class="btn secondary" id="selectTeam2Btn" onclick="selectTeam('team2')"></button>
        </div>

        <!-- Waiting Room Screen (Host) -->
        <div id="waitingRoomHost" class="screen">
            <h1>ØºØ±ÙØ© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</h1>
            <div class="room-code">
                <h2>Ø±Ù…Ø² Ø§Ù„ØºØ±ÙØ©</h2>
                <div class="code" id="displayRoomCode"></div>
            </div>
            <div class="players-list">
                <h3>Ø§Ù„Ù„Ø§Ø¹Ø¨ÙˆÙ† Ø§Ù„Ù…ØªØµÙ„ÙˆÙ†:</h3>
                <div id="connectedPlayers"></div>
            </div>
            <button class="btn success" id="startGameBtn" onclick="startGame()" disabled>Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
        </div>

        <!-- Waiting Room Screen (Player) -->
        <div id="waitingRoomPlayer" class="screen">
            <h1>ØºØ±ÙØ© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</h1>
            <div class="room-code">
                <h2>Ø±Ù…Ø² Ø§Ù„ØºØ±ÙØ©</h2>
                <div class="code" id="displayRoomCodePlayer"></div>
            </div>
            <div class="status-message info" id="teamAssignmentMessage"></div>
            <div class="players-list">
                <h3>Ø§Ù„Ù„Ø§Ø¹Ø¨ÙˆÙ† Ø§Ù„Ù…ØªØµÙ„ÙˆÙ†:</h3>
                <div id="connectedPlayersPlayer"></div>
            </div>
            <div class="status-message warning">
                Ø§Ù†ØªØ¸Ø± Ø­ØªÙ‰ ÙŠØ¨Ø¯Ø£ Ø§Ù„Ù…Ø¶ÙŠÙ Ø§Ù„Ù„Ø¹Ø¨Ø©...
            </div>
        </div>

        <!-- Host Game Screen -->
        <div id="hostGameScreen" class="screen">
            <h1>ğŸ›‹ï¸ Ù„Ø¹Ø¨Ø© Ø§Ù„ÙƒÙ†Ø¨Ø© ğŸ›‹ï¸</h1>
            
            <div class="question-display">
                <div class="timer" id="hostTimer">--</div>
                <div class="question-text" id="hostQuestion">Ø§Ø³ØªØ¹Ø¯ Ù„Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ...</div>
            </div>

            <div id="hostBuzzerIndicator"></div>

            <!-- Host Buzz Button -->
            <button class="buzz-button" id="hostBuzzButton" onclick="hostBuzzIn()" disabled>
                ğŸ””
            </button>

            <div class="status-message info" id="hostStatus">Ø§Ù†ØªØ¸Ø±...</div>

            <!-- Host Answer Options -->
            <div class="answer-options" id="hostAnswerOptions"></div>

            <!-- Host Choice Buttons -->
            <div class="choice-buttons" id="hostChoiceButtons"></div>

            <div class="game-board">
                <div class="team-section team1">
                    <div class="team-header">
                        <div class="team-name" id="hostTeam1Name"></div>
                    </div>
                    <div class="couch-container">
                        <div class="couch-title">ğŸ›‹ï¸ ÙƒÙ†Ø¨Ø© Ø§Ù„ÙÙˆØ²</div>
                        <div class="couch-players" id="hostTeam1Couch"></div>
                    </div>
                    <div class="waiting-players" id="hostTeam1Players"></div>
                </div>

                <div class="team-section team2">
                    <div class="team-header">
                        <div class="team-name" id="hostTeam2Name"></div>
                    </div>
                    <div class="couch-container">
                        <div class="couch-title">ğŸ›‹ï¸ ÙƒÙ†Ø¨Ø© Ø§Ù„ÙÙˆØ²</div>
                        <div class="couch-players" id="hostTeam2Couch"></div>
                    </div>
                    <div class="waiting-players" id="hostTeam2Players"></div>
                </div>
            </div>

            <button class="btn success" id="nextQuestionBtn" onclick="nextQuestion()">Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ</button>
        </div>

        <!-- Player Game Screen -->
        <div id="playerGameScreen" class="screen">
            <h1>ğŸ›‹ï¸ Ù„Ø¹Ø¨Ø© Ø§Ù„ÙƒÙ†Ø¨Ø© ğŸ›‹ï¸</h1>
            
            <div class="question-display">
                <div class="timer" id="playerTimer">--</div>
                <div class="question-text" id="playerQuestion">Ø§Ø³ØªØ¹Ø¯ Ù„Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ...</div>
            </div>

            <div id="buzzerIndicator"></div>

            <button class="buzz-button" id="buzzButton" onclick="buzzIn()" disabled>
                ğŸ””
            </button>

            <div class="status-message info" id="playerStatus">Ø§Ù†ØªØ¸Ø±...</div>

            <div class="answer-options" id="playerAnswerOptions"></div>

            <div class="choice-buttons" id="playerChoiceButtons"></div>

            <div class="game-board">
                <div class="team-section team1">
                    <div class="team-header">
                        <div class="team-name" id="team1Name"></div>
                    </div>
                    <div class="couch-container">
                        <div class="couch-title">ğŸ›‹ï¸ ÙƒÙ†Ø¨Ø© Ø§Ù„ÙÙˆØ²</div>
                        <div class="couch-players" id="team1Couch"></div>
                    </div>
                    <div class="waiting-players" id="team1Players"></div>
                </div>

                <div class="team-section team2">
                    <div class="team-header">
                        <div class="team-name" id="team2Name"></div>
                    </div>
                    <div class="couch-container">
                        <div class="couch-title">ğŸ›‹ï¸ ÙƒÙ†Ø¨Ø© Ø§Ù„ÙÙˆØ²</div>
                        <div class="couch-players" id="team2Couch"></div>
                    </div>
                    <div class="waiting-players" id="team2Players"></div>
                </div>
            </div>
        </div>

        <!-- Victory Screen -->
        <div id="victoryScreen">
            <div class="victory-content">
                <div id="victoryMessage"></div>
                <button class="btn" onclick="location.reload()">Ù„Ø¹Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCHNT7P6f4JyNGwPkF_MQSQdMalnn9YPgU",
            authDomain: "ramadan-questions-game.firebaseapp.com",
            databaseURL: "https://ramadan-questions-game-default-rtdb.firebaseio.com",
            projectId: "ramadan-questions-game",
            storageBucket: "ramadan-questions-game.firebasestorage.app",
            messagingSenderId: "966542858859",
            appId: "1:966542858859:web:18ba4e7ef46eaa3c29c3c9"
        };

        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        let currentRoomCode = null;
        let currentPlayerId = null;
        let currentTeam = null;
        let isHost = false;
        let roomData = {};
        let timerInterval = null;

        const questions = [
            {
                question: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ø°ÙŠ ÙŠØ£ØªÙŠ Ø¨Ø¹Ø¯ Ø±Ù…Ø¶Ø§Ù†ØŸ",
                options: ["Ø´ÙˆØ§Ù„", "Ø±Ø¬Ø¨", "Ø´Ø¹Ø¨Ø§Ù†", "Ø°Ùˆ Ø§Ù„Ù‚Ø¹Ø¯Ø©"],
                correct: 0
            },
            {
                question: "ÙƒÙ… Ø¹Ø¯Ø¯ Ø±ÙƒØ¹Ø§Øª ØµÙ„Ø§Ø© Ø§Ù„ØªØ±Ø§ÙˆÙŠØ­ØŸ",
                options: ["8 Ø±ÙƒØ¹Ø§Øª", "20 Ø±ÙƒØ¹Ø©", "11 Ø±ÙƒØ¹Ø©", "ØºÙŠØ± Ù…Ø­Ø¯Ø¯"],
                correct: 3
            },
            {
                question: "Ù…Ø§ Ù‡ÙŠ Ù„ÙŠÙ„Ø© Ø§Ù„Ù‚Ø¯Ø±ØŸ",
                options: ["Ø£ÙˆÙ„ Ù„ÙŠÙ„Ø© Ù…Ù† Ø±Ù…Ø¶Ø§Ù†", "Ù„ÙŠÙ„Ø© ÙÙŠ Ø§Ù„Ø¹Ø´Ø± Ø§Ù„Ø£ÙˆØ§Ø®Ø±", "Ø¢Ø®Ø± Ù„ÙŠÙ„Ø© Ù…Ù† Ø±Ù…Ø¶Ø§Ù†", "Ù„ÙŠÙ„Ø© Ø¹ÙŠØ¯ Ø§Ù„ÙØ·Ø±"],
                correct: 1
            },
            {
                question: "Ù…Ø§ Ù…Ø¹Ù†Ù‰ ÙƒÙ„Ù…Ø© Ø±Ù…Ø¶Ø§Ù†ØŸ",
                options: ["Ø§Ù„Ø¬ÙˆØ¹", "Ø§Ù„Ø±Ø­Ù…Ø©", "Ø§Ù„Ø­Ø± Ø§Ù„Ø´Ø¯ÙŠØ¯", "Ø§Ù„Ø¹Ø·Ø´"],
                correct: 2
            },
            {
                question: "Ù…ØªÙ‰ ÙØ±Ø¶ Ø§Ù„ØµÙŠØ§Ù… Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³Ù„Ù…ÙŠÙ†ØŸ",
                options: ["Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù„Ù„Ù‡Ø¬Ø±Ø©", "Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© Ù„Ù„Ù‡Ø¬Ø±Ø©", "Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø© Ù„Ù„Ù‡Ø¬Ø±Ø©", "Ù‚Ø¨Ù„ Ø§Ù„Ù‡Ø¬Ø±Ø©"],
                correct: 1
            },
            {
                question: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø·Ø¹Ø§Ù… Ø§Ù„Ø°ÙŠ ÙŠØ³ØªØ­Ø¨ Ø§Ù„Ø¥ÙØ·Ø§Ø± Ø¹Ù„ÙŠÙ‡ØŸ",
                options: ["Ø§Ù„ØªÙ…Ø±", "Ø§Ù„Ù…Ø§Ø¡", "Ø§Ù„Ø­Ù„ÙŠØ¨", "Ø§Ù„Ø®Ø¨Ø²"],
                correct: 0
            },
            {
                question: "ÙÙŠ Ø£ÙŠ Ø´Ù‡Ø± Ù†Ø²Ù„ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…ØŸ",
                options: ["Ø´Ø¹Ø¨Ø§Ù†", "Ø±Ù…Ø¶Ø§Ù†", "Ø´ÙˆØ§Ù„", "Ø±Ø¬Ø¨"],
                correct: 1
            },
            {
                question: "Ù…Ø§ Ø§Ø³Ù… Ø§Ù„ÙˆØ¬Ø¨Ø© Ø§Ù„ØªÙŠ ØªØ¤ÙƒÙ„ Ù‚Ø¨Ù„ Ø§Ù„ÙØ¬Ø± ÙÙŠ Ø±Ù…Ø¶Ø§Ù†ØŸ",
                options: ["Ø§Ù„Ø¥ÙØ·Ø§Ø±", "Ø§Ù„ØºØ¯Ø§Ø¡", "Ø§Ù„Ø³Ø­ÙˆØ±", "Ø§Ù„Ø¹Ø´Ø§Ø¡"],
                correct: 2
            }
        ];

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        function generateRoomCode() {
            return Math.floor(100000 + Math.random() * 900000).toString();
        }

        function createRoom() {
            const team1Name = document.getElementById('team1Name').value.trim();
            const team2Name = document.getElementById('team2Name').value.trim();
            const teamSize = parseInt(document.getElementById('teamSize').value);

            if (!team1Name || !team2Name) {
                alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„ÙØ±ÙŠÙ‚ÙŠÙ†');
                return;
            }

            currentRoomCode = generateRoomCode();
            isHost = true;

            const roomRef = database.ref('rooms/' + currentRoomCode);
            roomRef.set({
                team1Name: team1Name,
                team2Name: team2Name,
                teamSize: teamSize,
                players: {},
                team1Couch: [],
                team2Couch: [],
                team1Score: 0,
                team2Score: 0,
                currentQuestion: null,
                gameStarted: false,
                buzzedPlayer: null,
                showOptions: false,
                selectedAnswer: null,
                correctAnswer: null,
                bannedTeam: null,
                waitingForChoice: false,
                choicePlayer: null
            });

            document.getElementById('displayRoomCode').textContent = currentRoomCode;
            showScreen('waitingRoomHost');
            listenToRoom();
        }

        function joinRoom() {
            const playerName = document.getElementById('playerName').value.trim();
            const roomCode = document.getElementById('roomCode').value.trim();

            if (!playerName) {
                alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù…Ùƒ');
                return;
            }

            if (roomCode.length !== 6) {
                alert('Ø±Ù…Ø² Ø§Ù„ØºØ±ÙØ© ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 6 Ø£Ø±Ù‚Ø§Ù…');
                return;
            }

            currentRoomCode = roomCode;
            currentPlayerId = 'player_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);

            const roomRef = database.ref('rooms/' + currentRoomCode);
            roomRef.once('value', (snapshot) => {
                if (!snapshot.exists()) {
                    alert('Ø§Ù„ØºØ±ÙØ© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©');
                    return;
                }

                const room = snapshot.val();
                
                // Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† ÙÙŠ ÙƒÙ„ ÙØ±ÙŠÙ‚
                let team1Count = 0;
                let team2Count = 0;
                
                Object.values(room.players || {}).forEach(player => {
                    if (player.team === 'team1') team1Count++;
                    if (player.team === 'team2') team2Count++;
                });

                // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙØ±ÙŠÙ‚ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø¬Ø¯ÙŠØ¯
                let assignedTeam;
                if (team1Count < room.teamSize && team2Count < room.teamSize) {
                    // ÙƒÙ„Ø§ Ø§Ù„ÙØ±ÙŠÙ‚ÙŠÙ† Ù„Ø¯ÙŠÙ‡Ù…Ø§ Ù…Ø³Ø§Ø­Ø©
                    assignedTeam = team1Count <= team2Count ? 'team1' : 'team2';
                } else if (team1Count < room.teamSize) {
                    assignedTeam = 'team1';
                } else if (team2Count < room.teamSize) {
                    assignedTeam = 'team2';
                } else {
                    alert('Ø§Ù„ØºØ±ÙØ© Ù…Ù…ØªÙ„Ø¦Ø©');
                    return;
                }

                currentTeam = assignedTeam;

                const playerRef = roomRef.child('players/' + currentPlayerId);
                playerRef.set({
                    name: playerName,
                    team: assignedTeam,
                    joinedAt: Date.now()
                });

                document.getElementById('displayRoomCodePlayer').textContent = currentRoomCode;
                
                // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© ØªØ£ÙƒÙŠØ¯ Ø§Ù†Ø¶Ù…Ø§Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù„Ù„ÙØ±ÙŠÙ‚
                const teamName = assignedTeam === 'team1' ? room.team1Name : room.team2Name;
                document.getElementById('teamAssignmentMessage').textContent = `ØªÙ… Ø§Ù†Ø¶Ù…Ø§Ù…Ùƒ Ù„ÙØ±ÙŠÙ‚: ${teamName}`;
                
                showScreen('waitingRoomPlayer');
                listenToRoom();
            });
        }

        function selectTeam(team) {
            currentTeam = team;
            const roomRef = database.ref('rooms/' + currentRoomCode + '/players/' + currentPlayerId);
            roomRef.update({ team: team });
        }

        function listenToRoom() {
            const roomRef = database.ref('rooms/' + currentRoomCode);
            
            roomRef.on('value', (snapshot) => {
                if (!snapshot.exists()) return;
                
                roomData = snapshot.val();
                
                if (isHost) {
                    updateWaitingRoomHost();
                    if (roomData.gameStarted) {
                        showScreen('hostGameScreen');
                        updateHostGameScreen();
                    }
                } else {
                    updateWaitingRoomPlayer();
                    if (roomData.gameStarted) {
                        showScreen('playerGameScreen');
                        updatePlayerGameScreen();
                    }
                }

                checkVictory();
            });
        }

        function updateWaitingRoomHost() {
            const playersList = document.getElementById('connectedPlayers');
            playersList.innerHTML = '';

            const teamSize = roomData.teamSize || 2;
            let team1Count = 0;
            let team2Count = 0;

            Object.entries(roomData.players || {}).forEach(([id, player]) => {
                if (player.team === 'team1') team1Count++;
                if (player.team === 'team2') team2Count++;

                const div = document.createElement('div');
                div.className = 'player-item';
                
                const nameSpan = document.createElement('span');
                nameSpan.className = 'player-name';
                nameSpan.textContent = player.name;
                
                const badge = document.createElement('span');
                badge.className = `team-badge ${player.team}`;
                badge.textContent = player.team === 'team1' ? roomData.team1Name : roomData.team2Name;
                
                div.appendChild(nameSpan);
                div.appendChild(badge);
                playersList.appendChild(div);
            });

            const totalPlayers = team1Count + team2Count;
            const requiredPlayers = teamSize * 2;
            const startBtn = document.getElementById('startGameBtn');
            startBtn.disabled = totalPlayers < requiredPlayers;
            
            if (totalPlayers < requiredPlayers) {
                startBtn.textContent = `ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† (${totalPlayers}/${requiredPlayers})`;
            } else {
                startBtn.textContent = 'Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø©';
            }
        }

        function updateWaitingRoomPlayer() {
            const playersList = document.getElementById('connectedPlayersPlayer');
            playersList.innerHTML = '';

            Object.entries(roomData.players || {}).forEach(([id, player]) => {
                const div = document.createElement('div');
                div.className = 'player-item';
                
                const nameSpan = document.createElement('span');
                nameSpan.className = 'player-name';
                nameSpan.textContent = player.name;
                
                const badge = document.createElement('span');
                badge.className = `team-badge ${player.team}`;
                badge.textContent = player.team === 'team1' ? roomData.team1Name : roomData.team2Name;
                
                div.appendChild(nameSpan);
                div.appendChild(badge);
                playersList.appendChild(div);
            });
        }

        function startGame() {
            const roomRef = database.ref('rooms/' + currentRoomCode);
            roomRef.update({ gameStarted: true });
            nextQuestion();
        }

        function nextQuestion() {
            const randomQuestion = questions[Math.floor(Math.random() * questions.length)];
            
            const roomRef = database.ref('rooms/' + currentRoomCode);
            roomRef.update({
                currentQuestion: randomQuestion,
                buzzedPlayer: null,
                showOptions: false,
                selectedAnswer: null,
                correctAnswer: null,
                bannedTeam: null,
                waitingForChoice: false,
                choicePlayer: null,
                questionStartTime: Date.now()
            });

            document.getElementById('nextQuestionBtn').disabled = true;

            // ØªØ£Ø®ÙŠØ± 30 Ø«Ø§Ù†ÙŠØ© Ù‚Ø¨Ù„ Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª
            setTimeout(() => {
                if (!roomData.buzzedPlayer) {
                    roomRef.update({ showOptions: true });
                }
            }, 30000);

            startTimer(30);
        }

        function startTimer(seconds) {
            clearInterval(timerInterval);
            let timeLeft = seconds;
            
            const updateTimerDisplay = () => {
                const timerElements = document.querySelectorAll('.timer');
                timerElements.forEach(timer => {
                    timer.textContent = timeLeft;
                    if (timeLeft <= 5) {
                        timer.classList.add('warning');
                    } else {
                        timer.classList.remove('warning');
                    }
                });
            };

            updateTimerDisplay();

            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();

                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                }
            }, 1000);
        }

        function updateHostGameScreen() {
            document.getElementById('hostTeam1Name').textContent = roomData.team1Name;
            document.getElementById('hostTeam2Name').textContent = roomData.team2Name;

            const hostQuestion = document.getElementById('hostQuestion');
            const hostBuzzButton = document.getElementById('hostBuzzButton');
            const hostStatus = document.getElementById('hostStatus');
            const hostAnswerOptions = document.getElementById('hostAnswerOptions');
            const hostBuzzerIndicator = document.getElementById('hostBuzzerIndicator');

            if (roomData.currentQuestion) {
                hostQuestion.textContent = roomData.currentQuestion.question;
            }

            // Ø¹Ø±Ø¶ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ†Ø¨Ø©
            const team1CouchEl = document.getElementById('hostTeam1Couch');
            const team2CouchEl = document.getElementById('hostTeam2Couch');
            
            team1CouchEl.innerHTML = '';
            team2CouchEl.innerHTML = '';

            (roomData.team1Couch || []).forEach(playerId => {
                const player = roomData.players[playerId];
                if (player) {
                    const div = document.createElement('div');
                    div.className = 'couch-player';
                    div.textContent = player.name;
                    team1CouchEl.appendChild(div);
                }
            });

            (roomData.team2Couch || []).forEach(playerId => {
                const player = roomData.players[playerId];
                if (player) {
                    const div = document.createElement('div');
                    div.className = 'couch-player';
                    div.textContent = player.name;
                    team2CouchEl.appendChild(div);
                }
            });

            // Ø¹Ø±Ø¶ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ù…Ù†ØªØ¸Ø±ÙŠÙ†
            const team1PlayersEl = document.getElementById('hostTeam1Players');
            const team2PlayersEl = document.getElementById('hostTeam2Players');
            
            team1PlayersEl.innerHTML = '';
            team2PlayersEl.innerHTML = '';

            Object.entries(roomData.players || {}).forEach(([id, player]) => {
                const isOnCouch = (roomData.team1Couch || []).includes(id) || (roomData.team2Couch || []).includes(id);
                
                if (!isOnCouch) {
                    const div = document.createElement('div');
                    div.className = 'waiting-player';
                    div.textContent = player.name;
                    
                    if (player.team === 'team1') {
                        team1PlayersEl.appendChild(div);
                    } else {
                        team2PlayersEl.appendChild(div);
                    }
                }
            });

            // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø¶ÙŠÙ Ø¨Ù†ÙØ³ Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨
            if (roomData.buzzedPlayer) {
                const player = roomData.players[roomData.buzzedPlayer];
                const team = player.team === 'team1' ? roomData.team1Name : roomData.team2Name;
                hostBuzzerIndicator.innerHTML = `<div class="buzzer-indicator">ğŸ”” ${player.name} Ù…Ù† ${team} Ø¶ØºØ· Ø§Ù„Ø¬Ø±Ø³!</div>`;
            } else {
                hostBuzzerIndicator.innerHTML = '';
            }

            if (roomData.currentQuestion && !roomData.buzzedPlayer && !roomData.showOptions) {
                hostStatus.textContent = 'Ø§Ù†ØªØ¸Ø± Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†...';
                hostStatus.className = 'status-message info';
                hostBuzzButton.disabled = false;
                hostAnswerOptions.innerHTML = '';
            } else if (roomData.buzzedPlayer) {
                const buzzedPlayerData = roomData.players[roomData.buzzedPlayer];
                hostStatus.textContent = `${buzzedPlayerData.name} ÙŠØ¬ÙŠØ¨ Ø§Ù„Ø¢Ù†...`;
                hostStatus.className = 'status-message warning';
                hostBuzzButton.disabled = true;
                hostAnswerOptions.innerHTML = '';
            } else if (roomData.showOptions && !roomData.buzzedPlayer) {
                hostStatus.textContent = 'Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ù…ØªØ§Ø­Ø© Ù„Ù„Ø¬Ù…ÙŠØ¹!';
                hostStatus.className = 'status-message info';
                hostBuzzButton.disabled = true;
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ù„Ù„Ù…Ø¶ÙŠÙ
                hostAnswerOptions.innerHTML = '';
                roomData.currentQuestion.options.forEach((option, index) => {
                    const btn = document.createElement('button');
                    btn.className = 'answer-btn';
                    btn.textContent = option;
                    btn.onclick = () => hostSelectAnswer(index);
                    hostAnswerOptions.appendChild(btn);
                });
            } else if (!roomData.currentQuestion) {
                hostStatus.textContent = 'Ø§Ø¶ØºØ· "Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ" Ù„Ù„Ø¨Ø¯Ø¡';
                hostStatus.className = 'status-message info';
                hostBuzzButton.disabled = true;
                hostAnswerOptions.innerHTML = '';
            }
        }

        function hostBuzzIn() {
            if (!roomData.currentQuestion || roomData.buzzedPlayer || roomData.showOptions) return;

            // Ø§Ù„Ù…Ø¶ÙŠÙ Ù„Ø§ ÙŠØ­ØªØ§Ø¬ playerIdØŒ Ù„Ø°Ù„Ùƒ Ù†Ø³ØªØ®Ø¯Ù… Ù…Ø¹Ø±Ù Ø®Ø§Øµ
            const hostPlayerId = 'host';

            const roomRef = database.ref('rooms/' + currentRoomCode);
            roomRef.update({
                buzzedPlayer: hostPlayerId,
                questionStartTime: Date.now()
            });

            clearInterval(timerInterval);
            startTimer(5);
            
            setTimeout(() => {
                if (roomData.buzzedPlayer === hostPlayerId && !roomData.correctAnswer) {
                    roomRef.update({ showOptions: true });
                }
            }, 5000);
        }

        function hostSelectAnswer(answerIndex) {
            const roomRef = database.ref('rooms/' + currentRoomCode);
            const isCorrect = answerIndex === roomData.currentQuestion.correct;

            roomRef.update({
                selectedAnswer: answerIndex,
                correctAnswer: isCorrect
            });

            clearInterval(timerInterval);

            if (!isCorrect) {
                roomRef.update({
                    buzzedPlayer: null,
                    showOptions: true
                });
                
                // Ø¥Ø¹Ø·Ø§Ø¡ Ø§Ù„ÙØ±ØµØ© Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ù„Ù…Ø¯Ø© 10 Ø«ÙˆØ§Ù†ÙŠ
                startTimer(10);
                setTimeout(() => {
                    const nextBtn = document.getElementById('nextQuestionBtn');
                    if (nextBtn) nextBtn.disabled = false;
                }, 10000);
            }
        }

        function updatePlayerGameScreen() {
            document.getElementById('team1Name').textContent = roomData.team1Name;
            document.getElementById('team2Name').textContent = roomData.team2Name;

            const playerQuestion = document.getElementById('playerQuestion');
            const buzzButton = document.getElementById('buzzButton');
            const playerStatus = document.getElementById('playerStatus');
            const playerAnswerOptions = document.getElementById('playerAnswerOptions');
            const playerChoiceButtons = document.getElementById('playerChoiceButtons');
            const buzzerIndicator = document.getElementById('buzzerIndicator');

            if (roomData.currentQuestion) {
                playerQuestion.textContent = roomData.currentQuestion.question;
            }

            // Ø¹Ø±Ø¶ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ†Ø¨Ø©
            const team1CouchEl = document.getElementById('team1Couch');
            const team2CouchEl = document.getElementById('team2Couch');
            
            team1CouchEl.innerHTML = '';
            team2CouchEl.innerHTML = '';

            (roomData.team1Couch || []).forEach(playerId => {
                const player = roomData.players[playerId];
                if (player) {
                    const div = document.createElement('div');
                    div.className = 'couch-player';
                    div.textContent = player.name;
                    team1CouchEl.appendChild(div);
                }
            });

            (roomData.team2Couch || []).forEach(playerId => {
                const player = roomData.players[playerId];
                if (player) {
                    const div = document.createElement('div');
                    div.className = 'couch-player';
                    div.textContent = player.name;
                    team2CouchEl.appendChild(div);
                }
            });

            // Ø¹Ø±Ø¶ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ù…Ù†ØªØ¸Ø±ÙŠÙ†
            const team1PlayersEl = document.getElementById('team1Players');
            const team2PlayersEl = document.getElementById('team2Players');
            
            team1PlayersEl.innerHTML = '';
            team2PlayersEl.innerHTML = '';

            Object.entries(roomData.players || {}).forEach(([id, player]) => {
                const isOnCouch = (roomData.team1Couch || []).includes(id) || (roomData.team2Couch || []).includes(id);
                
                if (!isOnCouch) {
                    const div = document.createElement('div');
                    div.className = 'waiting-player';
                    div.textContent = player.name;
                    
                    if (player.team === 'team1') {
                        team1PlayersEl.appendChild(div);
                    } else {
                        team2PlayersEl.appendChild(div);
                    }
                }
            });

            if (roomData.buzzedPlayer && roomData.buzzedPlayer !== 'host') {
                const player = roomData.players[roomData.buzzedPlayer];
                const team = player.team === 'team1' ? roomData.team1Name : roomData.team2Name;
                buzzerIndicator.innerHTML = `<div class="buzzer-indicator">ğŸ”” ${player.name} Ù…Ù† ${team} Ø¶ØºØ· Ø§Ù„Ø¬Ø±Ø³!</div>`;
            } else if (roomData.buzzedPlayer === 'host') {
                buzzerIndicator.innerHTML = `<div class="buzzer-indicator">ğŸ”” Ø§Ù„Ù…Ø¶ÙŠÙ Ø¶ØºØ· Ø§Ù„Ø¬Ø±Ø³!</div>`;
            } else {
                buzzerIndicator.innerHTML = '';
            }

            if (roomData.waitingForChoice && roomData.choicePlayer === currentPlayerId) {
                playerStatus.textContent = 'Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! Ø§Ø®ØªØ±:';
                playerStatus.className = 'status-message success';
                buzzButton.disabled = true;
                playerAnswerOptions.innerHTML = '';
                
                const otherTeam = currentTeam === 'team1' ? 'team2' : 'team1';
                const hasOtherCouch = roomData[otherTeam + 'Couch']?.length > 0;
                
                playerChoiceButtons.innerHTML = '';
                
                const sitBtn = document.createElement('button');
                sitBtn.className = 'choice-btn sit';
                sitBtn.textContent = 'ğŸ›‹ï¸ Ø§Ø¬Ù„Ø³ Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ†Ø¨Ø©';
                sitBtn.onclick = () => makeChoice('sit');
                playerChoiceButtons.appendChild(sitBtn);
                
                if (hasOtherCouch) {
                    const stealBtn = document.createElement('button');
                    stealBtn.className = 'choice-btn steal';
                    stealBtn.textContent = 'ğŸ¯ Ø§Ø³Ø­Ø¨ Ù„Ø§Ø¹Ø¨ Ù…Ù† Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø¢Ø®Ø±';
                    stealBtn.onclick = () => makeChoice('steal');
                    playerChoiceButtons.appendChild(stealBtn);
                }
                
                return;
            } else {
                playerChoiceButtons.innerHTML = '';
            }

            const playerTeam = roomData.players[currentPlayerId]?.team;
            if (roomData.bannedTeam === playerTeam) {
                playerStatus.textContent = 'ÙØ±ÙŠÙ‚Ùƒ Ù…Ù…Ù†ÙˆØ¹ Ù…Ù† Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©!';
                playerStatus.className = 'status-message error';
                buzzButton.disabled = true;
                playerAnswerOptions.innerHTML = '';
                return;
            }

            if (roomData.showOptions && roomData.buzzedPlayer === currentPlayerId && !roomData.correctAnswer) {
                playerStatus.textContent = 'Ø§Ø®ØªØ± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©!';
                playerStatus.className = 'status-message info';
                buzzButton.disabled = true;
                
                playerAnswerOptions.innerHTML = '';
                roomData.currentQuestion.options.forEach((option, index) => {
                    const btn = document.createElement('button');
                    btn.className = 'answer-btn';
                    btn.textContent = option;
                    btn.onclick = () => selectAnswer(index);
                    playerAnswerOptions.appendChild(btn);
                });
                return;
            }

            // Ø¹Ø±Ø¶ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ù„Ù„Ø¬Ù…ÙŠØ¹ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ØªØ§Ø­Ø©
            if (roomData.showOptions && !roomData.buzzedPlayer) {
                playerStatus.textContent = 'Ø§Ø®ØªØ± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©!';
                playerStatus.className = 'status-message info';
                buzzButton.disabled = true;
                
                playerAnswerOptions.innerHTML = '';
                roomData.currentQuestion.options.forEach((option, index) => {
                    const btn = document.createElement('button');
                    btn.className = 'answer-btn';
                    btn.textContent = option;
                    btn.onclick = () => selectAnswerAfterTimeout(index);
                    playerAnswerOptions.appendChild(btn);
                });
                return;
            }

            if (roomData.correctAnswer !== null && roomData.buzzedPlayer === currentPlayerId) {
                playerAnswerOptions.innerHTML = '';
                buzzButton.disabled = true;
                
                if (roomData.correctAnswer) {
                    playerStatus.textContent = 'âœ… Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©!';
                    playerStatus.className = 'status-message success';
                } else {
                    playerStatus.textContent = 'âŒ Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©!';
                    playerStatus.className = 'status-message error';
                }
                return;
            }

            if (roomData.currentQuestion && !roomData.buzzedPlayer && !roomData.showOptions) {
                playerStatus.textContent = 'Ø§Ø¶ØºØ· Ø§Ù„Ø¬Ø±Ø³ Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø©!';
                playerStatus.className = 'status-message info';
                buzzButton.disabled = false;
                playerAnswerOptions.innerHTML = '';
            } else if (roomData.buzzedPlayer && roomData.buzzedPlayer !== currentPlayerId) {
                const buzzedPlayerData = roomData.buzzedPlayer === 'host' ? 
                    { name: 'Ø§Ù„Ù…Ø¶ÙŠÙ' } : 
                    roomData.players[roomData.buzzedPlayer];
                playerStatus.textContent = `${buzzedPlayerData.name} ÙŠØ¬ÙŠØ¨ Ø§Ù„Ø¢Ù†...`;
                playerStatus.className = 'status-message warning';
                buzzButton.disabled = true;
                playerAnswerOptions.innerHTML = '';
            } else if (!roomData.currentQuestion) {
                playerStatus.textContent = 'Ø§Ù†ØªØ¸Ø± Ø§Ù„Ø³Ø¤Ø§Ù„...';
                playerStatus.className = 'status-message info';
                buzzButton.disabled = true;
                playerAnswerOptions.innerHTML = '';
            }
        }

        function buzzIn() {
            if (!roomData.currentQuestion || roomData.buzzedPlayer || roomData.showOptions) return;

            const roomRef = database.ref('rooms/' + currentRoomCode);
            roomRef.update({
                buzzedPlayer: currentPlayerId,
                questionStartTime: Date.now()
            });

            clearInterval(timerInterval);
            startTimer(5);
            
            setTimeout(() => {
                if (roomData.buzzedPlayer === currentPlayerId && !roomData.correctAnswer) {
                    roomRef.update({ showOptions: true });
                }
            }, 5000);
        }

        function selectAnswer(answerIndex) {
            const roomRef = database.ref('rooms/' + currentRoomCode);
            const isCorrect = answerIndex === roomData.currentQuestion.correct;

            roomRef.update({
                selectedAnswer: answerIndex,
                correctAnswer: isCorrect
            });

            clearInterval(timerInterval);

            if (isCorrect) {
                const otherTeam = currentTeam === 'team1' ? 'team2' : 'team1';
                const hasOtherCouch = roomData[otherTeam + 'Couch']?.length > 0;
                
                if (hasOtherCouch) {
                    roomRef.update({
                        waitingForChoice: true,
                        choicePlayer: currentPlayerId
                    });
                } else {
                    addToCouch();
                }
            } else {
                roomRef.update({
                    bannedTeam: currentTeam,
                    buzzedPlayer: null,
                    showOptions: true
                });
                
                // Ø¥Ø¹Ø·Ø§Ø¡ Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø¢Ø®Ø± 10 Ø«ÙˆØ§Ù†ÙŠ
                startTimer(10);
                setTimeout(() => {
                    const nextBtn = document.getElementById('nextQuestionBtn');
                    if (nextBtn) nextBtn.disabled = false;
                }, 10000);
            }
        }

        function selectAnswerAfterTimeout(answerIndex) {
            const roomRef = database.ref('rooms/' + currentRoomCode);
            const isCorrect = answerIndex === roomData.currentQuestion.correct;

            if (isCorrect) {
                roomRef.update({
                    selectedAnswer: answerIndex,
                    correctAnswer: isCorrect,
                    buzzedPlayer: currentPlayerId
                });

                clearInterval(timerInterval);

                const otherTeam = currentTeam === 'team1' ? 'team2' : 'team1';
                const hasOtherCouch = roomData[otherTeam + 'Couch']?.length > 0;
                
                if (hasOtherCouch) {
                    roomRef.update({
                        waitingForChoice: true,
                        choicePlayer: currentPlayerId
                    });
                } else {
                    addToCouch();
                }
            }
        }

        function makeChoice(choice) {
            if (choice === 'sit') {
                addToCouch();
            } else if (choice === 'steal') {
                stealFromCouch();
            }
        }

        function addToCouch() {
            const couchKey = currentTeam + 'Couch';
            const scoreKey = currentTeam + 'Score';
            
            const newCouch = [...(roomData[couchKey] || []), currentPlayerId];
            const newScore = (roomData[scoreKey] || 0) + 1;

            const roomRef = database.ref('rooms/' + currentRoomCode);
            roomRef.update({
                [couchKey]: newCouch,
                [scoreKey]: newScore,
                waitingForChoice: false,
                choicePlayer: null
            });

            setTimeout(() => {
                const nextBtn = document.getElementById('nextQuestionBtn');
                if (nextBtn) nextBtn.disabled = false;
            }, 2000);
        }

        function stealFromCouch() {
            const otherTeam = currentTeam === 'team1' ? 'team2' : 'team1';
            const otherCouchKey = otherTeam + 'Couch';
            const couchKey = currentTeam + 'Couch';
            const scoreKey = currentTeam + 'Score';
            const otherScoreKey = otherTeam + 'Score';
            
            const otherCouch = [...(roomData[otherCouchKey] || [])];
            const stolenPlayer = otherCouch.pop();
            
            const newCouch = [...(roomData[couchKey] || []), currentPlayerId];
            const newScore = (roomData[scoreKey] || 0) + 1;
            const otherNewScore = Math.max(0, (roomData[otherScoreKey] || 0) - 1);

            const roomRef = database.ref('rooms/' + currentRoomCode);
            roomRef.update({
                [couchKey]: newCouch,
                [otherCouchKey]: otherCouch,
                [scoreKey]: newScore,
                [otherScoreKey]: otherNewScore,
                waitingForChoice: false,
                choicePlayer: null
            });

            setTimeout(() => {
                const nextBtn = document.getElementById('nextQuestionBtn');
                if (nextBtn) nextBtn.disabled = false;
            }, 2000);
        }

        function checkVictory() {
            const teamSize = roomData.teamSize || 2;
            
            if (roomData.team1Couch?.length >= teamSize) {
                showVictory(roomData.team1Name);
            } else if (roomData.team2Couch?.length >= teamSize) {
                showVictory(roomData.team2Name);
            }
        }

        function showVictory(teamName) {
            clearInterval(timerInterval);
            document.getElementById('victoryScreen').style.display = 'flex';
            document.getElementById('victoryMessage').textContent = `ğŸ‰ ${teamName} ÙØ§Ø² Ø¨Ø§Ù„Ù„Ø¹Ø¨Ø©! ğŸ‰`;
            const nextBtn = document.getElementById('nextQuestionBtn');
            if (nextBtn) nextBtn.style.display = 'none';
        }

        document.getElementById('roomCode')?.addEventListener('input', function(e) {
            this.value = this.value.replace(/[^0-9]/g, '');
        });
    </script>
</body>
</html>
